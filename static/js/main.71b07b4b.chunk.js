(this["webpackJsonp@pietrop/digital-paper-edit-client"]=this["webpackJsonp@pietrop/digital-paper-edit-client"]||[]).push([[0],{171:function(e,t,a){e.exports={speaker:"Paragraphs_speaker__1kdz6",unselectable:"Paragraphs_unselectable__3k2Ob",highlightedWord:"Paragraphs_highlightedWord__3mJtY"}},175:function(e,t,a){},242:function(e,t,a){e.exports=a(490)},247:function(e,t,a){},484:function(e,t){e.exports=function(e,t){var a=(e.getTime()-t.getTime())/1e3;return a/=60,Math.abs(Math.round(a))}},485:function(e,t,a){var n={"./cline.gif":486,"./line.gif":487,"./p2p.gif":488,"./point.gif":489};function r(e){var t=o(e);return a(t)}function o(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=o,e.exports=r,r.id=485},486:function(e,t,a){e.exports=a.p+"static/media/cline.c9d93ffa.gif"},487:function(e,t,a){e.exports=a.p+"static/media/line.8ed85f9f.gif"},488:function(e,t,a){e.exports=a.p+"static/media/p2p.8b6575a3.gif"},489:function(e,t,a){e.exports=a.p+"static/media/point.08c277d3.gif"},490:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(21),s=a.n(o),i=(a(247),a(11)),c=a(12),l=a(14),p=a(13),d=a(15),u=a(77),h=a(70),m=(a(248),a(4)),f=a.n(m),g=a(23),v=a(66),b=a(36),E=a(18),S=a(10),w=a(51),y=a(30),x=a(17),k=a(98),j=a(8),C=a(7),O=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleDelete=function(){!0===confirm("Click OK if you wish to delete, cancel if you don't")?a.props.handleDelete&&a.props.handleDelete(a.props.id):alert("All is good, it was not deleted")},a.handleEdit=function(){a.props.handleEdit(a.props.id)},a.showLinkPath=function(){return a.props.showLinkPath(a.props.id)},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(w.a.Item,null,r.a.createElement(E.a,null,r.a.createElement(k.LinkContainer,{to:this.showLinkPath(),style:{cursor:"pointer"}},r.a.createElement(S.a,{xs:8,sm:10,md:10,ld:10,xl:10},r.a.createElement(y.a.Title,null,this.props.icon," ",r.a.createElement("a",{href:"#".concat(this.showLinkPath())},this.props.title)))),r.a.createElement(S.a,{xs:2,sm:1,md:1,ld:1,xl:1},r.a.createElement(y.a.Link,null,r.a.createElement(x.a,{onClick:this.handleEdit,variant:"secondary",size:"sm"},r.a.createElement(j.a,{icon:C.D})))),r.a.createElement(S.a,{xs:2,sm:1,md:1,ld:1,xl:1},r.a.createElement(y.a.Link,null,r.a.createElement(x.a,{onClick:this.handleDelete,variant:"secondary",size:"sm"},r.a.createElement(j.a,{icon:C.Q}))))),r.a.createElement(k.LinkContainer,{to:this.showLinkPath(),style:{cursor:"pointer"}},r.a.createElement(E.a,null,r.a.createElement(S.a,{xs:10,sm:11,md:11,ld:11,xl:11},r.a.createElement(y.a.Subtitle,{className:"mb-2 text-muted"},this.props.description)))))}}]),t}(n.Component),T=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.items.map((function(t){return t.display?r.a.createElement(O,{key:t.id,id:t.id,title:t.title,icon:e.props.icon,description:t.description,handleEdit:e.props.handleEdit,handleDelete:e.props.handleDelete,showLinkPath:e.props.showLinkPath}):null})).filter((function(e){return null!==e}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{style:{height:"75vh",overflow:"scroll"}},t))}}]),t}(r.a.Component),P=function(e,t){return e.toLowerCase().trim().includes(t.toLowerCase().trim())},I=a(31),L=a(67),N=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleSearch=function(e){var t=e.target.value;a.props.handleSearch(t)},a.handleShowSearchBar=function(){a.setState((function(e){return{showSearchInput:!e.showSearchInput}}))},a.state={showSearchInput:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(I.a,{className:"mb-3"},r.a.createElement(I.a.Prepend,{onClick:this.handleShowSearchBar},r.a.createElement(I.a.Text,{id:"basic-addon2"},r.a.createElement(j.a,{icon:C.H}))),r.a.createElement(L.a,{style:{display:this.state.showSearchInput?"":"none"},onChange:this.handleSearch,placeholder:"Search","aria-label":"search","aria-describedby":"search"}))}}]),t}(r.a.Component),F=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleSearch=function(e){var t=a.props.items.filter((function(t){return P(t.title,e)||P(t.description,e)?(t.display=!0,t):(t.display=!1,t)}));a.props.handleUpdateList(t)},a.handleShowSearchBar=function(){a.setState((function(e){return{showSearchInput:!e.showSearchInput}}))},a.state={showSearchInput:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e;return null!==this.props.items&&0!==this.props.items.length&&(e=r.a.createElement(N,{handleSearch:this.handleSearch})),r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,null,r.a.createElement(S.a,{sm:9,md:9,ld:9,xl:9},e),r.a.createElement(S.a,{xs:12,sm:3,md:3,ld:3,xl:3},r.a.createElement(x.a,{onClick:this.props.handleShowCreateNewItemForm,variant:"secondary",size:"sm",block:!0},"New ",this.props.model))),this.props.items&&0===this.props.items.length?r.a.createElement("i",null,"There are no ",this.props.model,", create a new one to get started"):null,this.props.items?r.a.createElement(T,{icon:this.props.icon,items:this.props.items,handleEdit:this.props.handleEdit,handleDelete:this.props.handleDelete,showLinkPath:this.props.showLinkPath}):null)}}]),t}(r.a.Component),A=a(25),D=a(16),M=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleTitleChange=function(e){a.setState({title:e.target.value})},a.handleDescriptionChange=function(e){a.setState({description:e.target.value})},a.state={title:a.props.title,description:a.props.description,validated:!1,id:a.props.id},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleSubmit",value:function(e){var t=e.currentTarget;if(t.checkValidity()||(e.preventDefault(),e.stopPropagation(),this.setState({validated:!0})),t.checkValidity()){e.preventDefault(),e.stopPropagation();var a={title:this.state.title,description:this.state.description,id:this.state.id};this.props.handleSaveForm(a)}}},{key:"render",value:function(){var e=this;return r.a.createElement(D.a,{noValidate:!0,validated:this.state.validated,onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement(D.a.Group,{controlId:"formBasicEmail"},r.a.createElement(D.a.Label,null,"Title "),r.a.createElement(D.a.Control,{required:!0,type:"text",placeholder:"Enter a project title",value:this.state.title,onChange:this.handleTitleChange}),r.a.createElement(D.a.Text,{className:"text-muted"},"Chose a title"),r.a.createElement(D.a.Control.Feedback,null,"Looks good!"),r.a.createElement(D.a.Control.Feedback,{type:"invalid"},"Please chose a title")),r.a.createElement(D.a.Group,{controlId:"formBasicEmail"},r.a.createElement(D.a.Label,null,"Description "),r.a.createElement(D.a.Control,{type:"text",placeholder:"Enter a project description",value:this.state.description,onChange:this.handleDescriptionChange}),r.a.createElement(D.a.Text,{className:"text-muted"},"Chose an optional description"),r.a.createElement(D.a.Control.Feedback,null,"Looks good!"),r.a.createElement(D.a.Control.Feedback,{type:"invalid"},"Please chose a description")),r.a.createElement(A.a.Footer,null,r.a.createElement(x.a,{variant:"primary",type:"submit"},"Save")))}}]),t}(n.Component),U=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleClose=function(){a.props.handleCloseModal()},a.state={title:"title"},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(A.a,{show:this.props.show,onHide:this.handleClose},r.a.createElement(A.a.Header,{closeButton:!0},r.a.createElement(A.a.Title,null,this.props.modalTitle)),r.a.createElement(A.a.Body,null,r.a.createElement(M,{title:this.props.title,description:this.props.description,id:this.props.id,handleSaveForm:this.props.handleSaveForm})))}}]),t}(r.a.Component),B=a(143),_=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.items.map((function(e,t){return e.link?r.a.createElement(k.LinkContainer,{key:t,to:e.link},r.a.createElement(B.a.Item,null,e.name)):r.a.createElement(B.a.Item,{key:t,active:!0},e.name)}));return r.a.createElement(r.a.Fragment,null,r.a.createElement("style",{scoped:!0},"\n        .breadcrumb{ \n          background-color: ".concat(this.props.backgroundColor,";\n          ").concat(this.props.backgroundColor?" margin: 0px":""," \n          }\n        ")),r.a.createElement("div",null,r.a.createElement(B.a,null,e)))}}]),t}(n.Component);a(239);var R=a(221),W=a.n(R),J=["GET","POST","PUT","DELETE"],V=function(e){if(!J.includes(e))throw new Error("Wrong method passed ".concat(e," - should be one of ").concat(J))},q=function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return"PUT"===e?t={method:e,mode:"cors",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}:"POST"===e?(t={method:e},"json"===n?(t.headers={"Content-Type":"application/json"},t.body=JSON.stringify(a)):t.body=a):t={method:e,mode:"cors"},t};var z=function(e){var t,a,n,r,o=arguments;return f.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return t=o.length>1&&void 0!==o[1]?o[1]:"GET",a=o.length>2&&void 0!==o[2]?o[2]:{},n=o.length>3?o[3]:void 0,V(t),r=q(t,a,n),s.next=7,f.a.awrap(fetch(e,r));case 7:return s.abrupt("return",s.sent);case 8:case"end":return s.stop()}}))},H=function(){function e(){var t=this;Object(i.a)(this,e),this.projectsIdUrl=function(e){return"".concat(t.projectsUrl,"/").concat(e)},this.transcriptsUrl=function(e){return"".concat(t.projectsIdUrl(e),"/transcripts")},this.transcriptsIdUrl=function(e,a,n){var r=n?"?".concat(W.a.stringify(n)):"";return"".concat(t.transcriptsUrl(e),"/").concat(a).concat(r).trim()},this.paperEditsUrl=function(e){return"".concat(t.projectsIdUrl(e),"/paperedits")},this.paperEditsIdUrl=function(e,a){return"".concat(t.projectsIdUrl(e),"/paperedits/").concat(a)},this.annotationsUrl=function(e,a){return"".concat(t.transcriptsIdUrl(e,a),"/annotations")},this.annotationsIdUrl=function(e,a,n){return"".concat(t.transcriptsIdUrl(e,a),"/annotations/").concat(n)},this.labelsUrl=function(e){return"".concat(t.projectsIdUrl(e),"/labels")},this.labelsIdUrl=function(e,a){return"".concat(t.projectsIdUrl(e),"/labels/").concat(a)},this.baseUrl=window.env.API_URL,window.env.API_URL=null,this.projectsUrl="".concat(this.baseUrl,"/api/projects")}return Object(c.a)(e,[{key:"getAllProjects",value:function(){var e,t;return f.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f.a.awrap(z(this.projectsUrl));case 2:return e=a.sent,a.next=5,f.a.awrap(e.json());case 5:return t=a.sent,a.abrupt("return",t.projects);case 7:case"end":return a.stop()}}),null,this)}},{key:"getProject",value:function(e){var t,a;return f.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.a.awrap(z(this.projectsIdUrl(e)));case 2:return t=n.sent,n.next=5,f.a.awrap(t.json());case 5:return a=n.sent,n.abrupt("return",a);case 7:case"end":return n.stop()}}),null,this)}},{key:"createProject",value:function(e){var t;return f.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f.a.awrap(z(this.projectsUrl,"POST",e,"json"));case 2:return t=a.sent,a.next=5,f.a.awrap(t.json());case 5:return a.abrupt("return",a.sent);case 6:case"end":return a.stop()}}),null,this)}},{key:"updateProject",value:function(e,t){var a,n;return f.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,f.a.awrap(z(this.projectsIdUrl(e),"PUT",t));case 2:return a=r.sent,r.next=5,f.a.awrap(a.json());case 5:return n=r.sent,r.abrupt("return",n);case 7:case"end":return r.stop()}}),null,this)}},{key:"deleteProject",value:function(e){var t;return f.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f.a.awrap(z(this.projectsIdUrl(e),"DELETE"));case 2:return t=a.sent,a.abrupt("return",t);case 4:case"end":return a.stop()}}),null,this)}},{key:"getTranscripts",value:function(e){var t,a;return f.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.a.awrap(z(this.transcriptsUrl(e)));case 2:return t=n.sent,n.next=5,f.a.awrap(t.json());case 5:return a=n.sent,n.abrupt("return",a);case 7:case"end":return n.stop()}}),null,this)}},{key:"createTranscript",value:function(e,t){var a,n;return f.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,f.a.awrap(z(this.transcriptsUrl(e),"POST",t));case 2:return a=r.sent,r.next=5,f.a.awrap(a.json());case 5:return n=r.sent,r.abrupt("return",n);case 7:case"end":return r.stop()}}),null,this)}},{key:"getTranscript",value:function(e,t,a){var n,r,o;return f.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,f.a.awrap(z(this.transcriptsIdUrl(e,t,a)));case 2:return n=s.sent,s.next=5,f.a.awrap(n.json());case 5:return r=s.sent,s.next=8,f.a.awrap(this.getProject(e));case 8:return o=s.sent,r.projectTitle=o.project.title,r.transcriptTitle=r.title,delete r.title,s.abrupt("return",r);case 13:case"end":return s.stop()}}),null,this)}},{key:"updateTranscript",value:function(e,t,a,n){var r;return f.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,f.a.awrap(z(this.transcriptsIdUrl(e,t,a),"PUT",n));case 2:return r=o.sent,o.abrupt("return",r);case 4:case"end":return o.stop()}}),null,this)}},{key:"deleteTranscript",value:function(e,t){var a;return f.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.a.awrap(z(this.transcriptsIdUrl(e,t),"DELETE"));case 2:return a=n.sent,n.abrupt("return",a);case 4:case"end":return n.stop()}}),null,this)}},{key:"getAllAnnotations",value:function(e,t){var a,n;return f.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,f.a.awrap(fetch(this.annotationsUrl(e,t)));case 2:return a=r.sent,r.next=5,f.a.awrap(a.json());case 5:return n=r.sent,r.abrupt("return",n);case 7:case"end":return r.stop()}}),null,this)}},{key:"getAnnotation",value:function(e,t,a){var n,r;return f.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,f.a.awrap(z(this.annotationsIdUrl(e,t,a)));case 2:return n=o.sent,o.next=5,f.a.awrap(n.json());case 5:return r=o.sent,o.abrupt("return",r);case 7:case"end":return o.stop()}}),null,this)}},{key:"createAnnotation",value:function(e,t,a){var n;return f.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,f.a.awrap(z(this.annotationsUrl(e,t),"POST",a,"json"));case 2:return n=r.sent,r.next=5,f.a.awrap(n.json());case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}}),null,this)}},{key:"updateAnnotation",value:function(e,t,a,n){var r,o;return f.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,f.a.awrap(z(this.annotationsIdUrl(e,t,a),"PUT",n));case 2:return r=s.sent,s.next=5,f.a.awrap(r.json());case 5:return o=s.sent,s.abrupt("return",o);case 7:case"end":return s.stop()}}),null,this)}},{key:"deleteAnnotation",value:function(e,t,a){var n,r;return f.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,f.a.awrap(z(this.annotationsIdUrl(e,t,a),"DELETE"));case 2:return n=o.sent,o.next=5,f.a.awrap(n.json());case 5:return r=o.sent,o.abrupt("return",r);case 7:case"end":return o.stop()}}),null,this)}},{key:"getAllLabels",value:function(e){var t,a;return f.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.a.awrap(fetch(this.labelsUrl(e)));case 2:return t=n.sent,n.next=5,f.a.awrap(t.json());case 5:return a=n.sent,n.abrupt("return",a);case 7:case"end":return n.stop()}}),null,this)}},{key:"getLabel",value:function(e,t){var a,n;return f.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,f.a.awrap(z(this.labelsIdUrl(e,t)));case 2:return a=r.sent,r.next=5,f.a.awrap(a.json());case 5:return n=r.sent,r.abrupt("return",n);case 7:case"end":return r.stop()}}),null,this)}},{key:"createLabel",value:function(e,t){var a,n;return f.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,f.a.awrap(z(this.labelsUrl(e),"POST",t,"json"));case 2:return a=r.sent,r.next=5,f.a.awrap(a.json());case 5:return n=r.sent,r.abrupt("return",n);case 7:case"end":return r.stop()}}),null,this)}},{key:"updateLabel",value:function(e,t,a){var n,r;return f.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,f.a.awrap(z(this.labelsIdUrl(e,t),"PUT",a));case 2:return n=o.sent,o.next=5,f.a.awrap(n.json());case 5:return r=o.sent,o.abrupt("return",r);case 7:case"end":return o.stop()}}),null,this)}},{key:"deleteLabel",value:function(e,t){var a,n;return f.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,f.a.awrap(z(this.labelsIdUrl(e,t),"DELETE"));case 2:return a=r.sent,r.next=5,f.a.awrap(a.json());case 5:return n=r.sent,r.abrupt("return",n);case 7:case"end":return r.stop()}}),null,this)}},{key:"getAllPaperEdits",value:function(e){var t,a;return f.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.a.awrap(z(this.paperEditsUrl(e)));case 2:return t=n.sent,n.next=5,f.a.awrap(t.json());case 5:return a=n.sent,n.abrupt("return",a.paperedits);case 7:case"end":return n.stop()}}),null,this)}},{key:"getPaperEdit",value:function(e,t){var a,n;return f.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,f.a.awrap(z(this.paperEditsIdUrl(e,t)));case 2:return a=r.sent,r.next=5,f.a.awrap(a.json());case 5:return n=r.sent,r.abrupt("return",n);case 7:case"end":return r.stop()}}),null,this)}},{key:"createPaperEdit",value:function(e,t){var a;return f.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.a.awrap(z(this.paperEditsUrl(e),"POST",t,"json"));case 2:return a=n.sent,n.next=5,f.a.awrap(a.json());case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),null,this)}},{key:"updatePaperEdit",value:function(e,t,a){var n,r;return f.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,f.a.awrap(z(this.paperEditsIdUrl(e,t),"PUT",a));case 2:return n=o.sent,o.next=5,f.a.awrap(n.json());case 5:return r=o.sent,o.abrupt("return",r);case 7:case"end":return o.stop()}}),null,this)}},{key:"deletePaperEdit",value:function(e,t){var a;return f.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.a.awrap(z(this.paperEditsIdUrl(e,t),"DELETE"));case 2:return a=n.sent,n.abrupt("return",a);case 4:case"end":return n.stop()}}),null,this)}},{key:"getTranscriptLabelsAnnotations",value:function(e,t){var a,n,r,o;return f.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,f.a.awrap(this.getTranscript(e,t));case 2:return a=s.sent,s.next=5,f.a.awrap(this.getAllLabels(e,t));case 5:return n=s.sent,s.next=8,f.a.awrap(this.getAllAnnotations(e,t));case 8:return r=s.sent,o={transcriptId:t,projectId:e,projectTitle:a.projectTitle,transcriptTitle:a.transcriptTitle,url:a.url,labels:n.labels,transcript:a.transcript,annotations:r.annotations},s.abrupt("return",o);case 11:case"end":return s.stop()}}),null,this)}},{key:"getProgrammeScriptAndTranscripts",value:function(e,t){var a,n,r,o,s,i,c,l=this;return f.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,f.a.awrap(this.getTranscripts(e));case 2:return a=p.sent,p.next=5,f.a.awrap(Promise.all(a.transcripts.map((function(t){return l.getTranscript(e,t.id)}))));case 5:return n=p.sent,p.next=8,f.a.awrap(Promise.all(a.transcripts.map((function(t){return l.getAllAnnotations(e,t.id)}))));case 8:return r=p.sent,n.forEach((function(e){var t=r.find((function(t){return t.transcriptId===e.id}));e.annotations=t?t.annotations:[]})),p.next=12,f.a.awrap(this.getPaperEdit(e,t));case 12:return o=p.sent,p.next=15,f.a.awrap(this.getProject(e));case 15:return s=p.sent,p.next=18,f.a.awrap(this.getAllLabels(e));case 18:return i=p.sent,c={programmeScript:o.programmeScript,project:s.project,transcripts:n,labels:i.labels},p.abrupt("return",c);case 21:case"end":return p.stop()}}),null,this)}},{key:"exportVideo",value:function(e,t){return f.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise((function(a,n){a({input:e,output:"~/Desktop/".concat(t),ffmpegPath:""})})));case 1:case"end":return a.stop()}}))}},{key:"exportAudio",value:function(e,t,a,n,r){return f.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise((function(a,n){a({input:e,output:"~/Desktop/".concat(t),ffmpegPath:""})})));case 1:case"end":return a.stop()}}))}}]),e}(),K=function(){function e(){Object(i.a)(this,e)}return Object(c.a)(e,[{key:"getAllProjects",value:function(){var e,t,a;return f.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.a.awrap(fetch("db/projects.json"));case 2:return e=n.sent,n.next=5,f.a.awrap(e.json());case 5:if(t=n.sent,0,0===t.length){n.next=10;break}return a=t.map((function(e){return e.id=e._id,e})),n.abrupt("return",a);case 10:case"end":return n.stop()}}))}},{key:"getProject",value:function(e){var t,a,n;return f.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,f.a.awrap(fetch("db/projects.json"));case 2:return t=r.sent,r.next=5,f.a.awrap(t.json());case 5:return a=r.sent,n=a.find((function(t){return t._id===e})),r.abrupt("return",{status:"ok",project:n});case 8:case"end":return r.stop()}}))}},{key:"createProject",value:function(e){return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),e.abrupt("return",{status:"false"});case 2:case"end":return e.stop()}}))}},{key:"updateProject",value:function(e,t){return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),e.abrupt("return",{status:"false"});case 2:case"end":return e.stop()}}))}},{key:"deleteProject",value:function(e){return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),e.abrupt("return",{ok:!1,status:"false",project:{}});case 2:case"end":return e.stop()}}))}},{key:"getTranscripts",value:function(e){var t,a;return f.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.a.awrap(fetch("db/transcripts.json"));case 2:return t=n.sent,n.next=5,f.a.awrap(t.json());case 5:return a=(a=(a=n.sent).filter((function(t){return t.projectId===e}))).map((function(e){return e.id=e._id,e})),n.abrupt("return",{transcripts:a});case 9:case"end":return n.stop()}}))}},{key:"createTranscript",value:function(e,t,a){return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),e.abrupt("return",{status:"false"});case 2:case"end":return e.stop()}}))}},{key:"getTranscript",value:function(e,t,a){var n,r,o,s;return f.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f.a.awrap(fetch("db/transcripts.json"));case 2:return n=a.sent,a.next=5,f.a.awrap(n.json());case 5:return r=a.sent,(o=r.find((function(e){return e._id===t}))).id=o._id,a.next=10,f.a.awrap(this.getProject(e));case 10:return s=a.sent,o.projectTitle=s.project.title,o.transcriptTitle=o.title,a.abrupt("return",o);case 14:case"end":return a.stop()}}),null,this)}},{key:"updateTranscript",value:function(e,t,a,n){return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),e.abrupt("return",{ok:!1});case 2:case"end":return e.stop()}}))}},{key:"deleteTranscript",value:function(e,t){return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),e.abrupt("return",{ok:!1,status:"false"});case 2:case"end":return e.stop()}}))}},{key:"getAllAnnotations",value:function(e,t){var a,n;return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.awrap(fetch("db/annotations.json"));case 2:return a=e.sent,e.next=5,f.a.awrap(a.json());case 5:return n=(n=(n=e.sent).filter((function(e){return e.transcriptId===t})))?n.map((function(e){return e.id=e._id,e})):[],e.abrupt("return",{annotations:n});case 9:case"end":return e.stop()}}))}},{key:"getAnnotation",value:function(e,t,a){var n,r,o;return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.awrap(fetch("db/annotations.json"));case 2:return n=e.sent,e.next=5,f.a.awrap(n.json());case 5:return r=e.sent,o=r[0],e.abrupt("return",{annotation:o});case 8:case"end":return e.stop()}}))}},{key:"createAnnotation",value:function(e,t,a){return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),e.abrupt("return",{ok:!1,status:"false",annotation:[]});case 2:case"end":return e.stop()}}))}},{key:"deleteAnnotation",value:function(e,t,a){return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),e.abrupt("return",{ok:!1,status:"false"});case 2:case"end":return e.stop()}}))}},{key:"getAllLabels",value:function(e){var t,a,n;return f.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,f.a.awrap(fetch("db/labels.json"));case 2:return t=r.sent,r.next=5,f.a.awrap(t.json());case 5:return a=r.sent,n=a[0],(a=a.filter((function(t){return t.projectId===e}))).unshift(n),a||(a=[]),r.abrupt("return",{ok:!0,status:"ok",labels:a});case 11:case"end":return r.stop()}}))}},{key:"getLabel",value:function(e,t){var a,n,r;return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.awrap(fetch("db/labels.json"));case 2:return a=e.sent,e.next=5,f.a.awrap(a.json());case 5:return n=e.sent,r=n[0],e.abrupt("return",{ok:!0,status:"ok",label:r});case 8:case"end":return e.stop()}}))}},{key:"createLabel",value:function(e,t){return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),e.abrupt("return",{ok:!1,status:"false"});case 2:case"end":return e.stop()}}))}},{key:"updateLabel",value:function(e,t,a){return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),e.abrupt("return",{ok:!1,status:"false"});case 2:case"end":return e.stop()}}))}},{key:"deleteLabel",value:function(e,t){return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),e.abrupt("return",{status:"false"});case 2:case"end":return e.stop()}}))}},{key:"getAllPaperEdits",value:function(e){var t,a,n;return f.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,f.a.awrap(fetch("db/paperedits.json"));case 2:return t=r.sent,r.next=5,f.a.awrap(t.json());case 5:return a=(a=r.sent).filter((function(t){return t.projectId===e})),(n={}).paperedits=[],n.paperedits=a,n.paperedits&&(n.paperedits=n.paperedits.map((function(e){return e.id=e._id,e}))),r.abrupt("return",n.paperedits);case 12:case"end":return r.stop()}}))}},{key:"getPaperEdit",value:function(e,t){var a,n,r,o;return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t,e.next=3,f.a.awrap(fetch("db/paperedits.json"));case 3:return n=e.sent,e.next=6,f.a.awrap(n.json());case 6:return r=e.sent,(o=r.find((function(e){return e.id===a})))||(new Error("No paper edit found").statusCode=404),e.abrupt("return",{ok:!0,status:"ok",programmeScript:o});case 10:case"end":return e.stop()}}))}},{key:"createPaperEdit",value:function(e,t){return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),e.abrupt("return",{ok:!1,status:"false"});case 2:case"end":return e.stop()}}))}},{key:"updatePaperEdit",value:function(e,t,a){return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),e.abrupt("return",{ok:!0,status:"false"});case 2:case"end":return e.stop()}}))}},{key:"deletePaperEdit",value:function(e,t){return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),e.abrupt("return",{ok:!1,status:"false"});case 2:case"end":return e.stop()}}))}},{key:"getTranscriptLabelsAnnotations",value:function(e,t){var a,n,r,o;return f.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,f.a.awrap(this.getTranscript(e,t));case 2:return a=s.sent,s.next=5,f.a.awrap(this.getAllLabels(e,t));case 5:return n=s.sent,s.next=8,f.a.awrap(this.getAllAnnotations(e,t));case 8:return r=s.sent,o={transcriptId:t,projectId:e,projectTitle:a.projectTitle,transcriptTitle:a.transcriptTitle,url:a.url,labels:n.labels,transcript:a.transcript,annotations:r.annotations},s.abrupt("return",o);case 11:case"end":return s.stop()}}),null,this)}},{key:"getProgrammeScriptAndTranscripts",value:function(e,t){var a,n,r,o,s,i,c,l=this;return f.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,f.a.awrap(this.getTranscripts(e));case 2:return a=p.sent,p.next=5,f.a.awrap(Promise.all(a.transcripts.map((function(t){return l.getTranscript(e,t.id)}))));case 5:return n=p.sent,p.next=8,f.a.awrap(Promise.all(a.transcripts.map((function(t){return l.getAllAnnotations(e,t.id)}))));case 8:return r=p.sent,n.forEach((function(e){var t=r.find((function(t){return t.transcriptId===e.id}));e.annotations=t?t.annotations:[]})),p.next=12,f.a.awrap(this.getPaperEdit(e,t));case 12:return o=p.sent,p.next=15,f.a.awrap(this.getProject(e));case 15:return s=p.sent,p.next=18,f.a.awrap(this.getAllLabels(e));case 18:return i=p.sent,c={programmeScript:o.programmeScript,project:s.project,transcripts:n,labels:i.labels},p.abrupt("return",c);case 21:case"end":return p.stop()}}),null,this)}}]),e}();function G(){return void 0===window.process?"demo":void 0!==window.process.versions.electron?(console.debug("In Electron Enviroment"),"electron"):void 0!==window.process.versions.cep?(console.debug("In Adobe CEP Environment"),"cep"):void console.error("couldn't determine the js environment")}var X=G,Y=X(),Q=function(){if("demo"===Y){console.log("API Wrapper demo time!");var e=new K;return Object.freeze(e),e}if("browser"===Y){var t=new H;return Object.freeze(t),t}if("electron"===Y){var a=new(0,window.ElectronWrapper);return Object.freeze(a),a}if("cep"===Y){var n=new(0,window.AdobeCEPWrapper);return Object.freeze(n),n}}(),$=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleSaveItem=function(e){e.id?Q.updateProject(e.id,e).then((function(t){if("ok"===t.status){var n=t.project;n.display=!0;var r=a.state.items;a.findItemById(r,e),r[a.state.items.findIndex((function(e){return e.id===n.id}))]=n,a.setState({isNewItemModalShow:!1,items:r,title:"",itemId:null,description:""})}})):Q.createProject(e).then((function(e){if("ok"===e.status){var t=Object(g.a)(a.state.items);e.project.display=!0,t.push(e.project),a.setState({isNewItemModalShow:!1,items:t,title:"",itemId:null,description:""})}}))},a.findItemById=function(e,t){return e.filter((function(e){return e.id===t}))[0]},a.handleEditItem=function(e){var t=a.findItemById(a.state.items,e);a.setState({title:t.title,itemId:t.id,description:t.description,isNewItemModalShow:!0}),console.log("edit item",t)},a.showLinkPathToItem=function(e){return"/projects/".concat(e)},a.handleUpdateList=function(e){a.setState({items:e})},a.handleShowCreateNewItemForm=function(){a.setState({isNewItemModalShow:!0})},a.handleCloseModal=function(){a.setState({title:"",itemId:null,description:"",isNewItemModalShow:!1})},a.state={items:[],isNewItemModalShow:!1,title:"",description:"",itemId:null},a.handleDeleteItem=a.handleDeleteItem.bind(Object(v.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e,t;return f.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,f.a.awrap(Q.getAllProjects());case 3:(e=a.sent)&&(t=e.map((function(e){return e.display=!0,e})),this.setState({items:t})),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log("Error with ApiWrapper.getAllProjects",a.t0);case 10:case"end":return a.stop()}}),null,this,[[0,7]])}},{key:"handleDeleteItem",value:function(e){var t;return f.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f.a.awrap(Q.deleteProject(e));case 2:a.sent.ok&&(t=this.state.items.filter((function(t){return t.id!==e})),this.setState({items:t}));case 4:case"end":return a.stop()}}),null,this)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.HashRouter,null,r.a.createElement(b.a,{style:{marginBottom:"5em",marginTop:"1em"}},r.a.createElement(E.a,null,r.a.createElement(S.a,{sm:12,md:12,ld:12,xl:12},r.a.createElement(_,{items:[{name:"Projects"}]}))),r.a.createElement(F,{model:"Project",items:this.state.items,icon:r.a.createElement(j.a,{icon:C.s,color:"#007bff"}),handleShowCreateNewItemForm:this.handleShowCreateNewItemForm,deleteItem:this.createNew,editItem:this.createNew,handleEdit:this.handleEditItem,handleDelete:this.handleDeleteItem,showLinkPath:this.showLinkPathToItem,handleUpdateList:this.handleUpdateList}),r.a.createElement(U,{title:this.state.title,description:this.state.description,id:this.state.itemId,modalTitle:this.state.itemId?"Edit Project":"New Project",show:this.state.isNewItemModalShow,handleCloseModal:this.handleCloseModal,handleSaveForm:this.handleSaveItem}))))}}]),t}(r.a.Component),Z=a(241),ee=a(69),te=a(84),ae=a(80),ne=a(222),re=a(142),oe=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleDelete=function(){!0===confirm("Click OK if you wish to delete, cancel if you don't")?a.props.handleDelete&&a.props.handleDelete(a.props.id):alert("All is good, it was not deleted")},a.handleEdit=function(){a.props.handleEdit(a.props.id)},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t;"error"===this.props.status&&(e="danger"),"in-progress"===this.props.status&&(e="info",r.a.createElement(te.a,{variant:"info"},"In progress")),"done"===this.props.status&&(r.a.createElement(te.a,{variant:"success"},"Success"),e="success");var a=r.a.createElement("a",{href:"#".concat(this.props.showLink())}," ",this.props.title);return e&&"info"===e&&(a=this.props.title),e&&"danger"===e&&(a=this.props.title,"danger"),"error"===this.props.status&&(t=r.a.createElement(r.a.Fragment,null,r.a.createElement(ae.a,{variant:"danger"},r.a.createElement(j.a,{icon:C.i})," ",this.props.errorMessage),r.a.createElement(te.a,{variant:"danger"},"Error"))),r.a.createElement(w.a.Item,null,r.a.createElement(E.a,null,r.a.createElement(S.a,{xs:12,sm:9,md:9,ld:9,xl:9},r.a.createElement(y.a.Title,null,this.props.icon?this.props.icon:""," ",a)),r.a.createElement(S.a,{xs:2,sm:1,md:1,ld:1,xl:1},r.a.createElement(y.a.Link,null,r.a.createElement(x.a,{onClick:this.handleEdit,variant:"secondary",size:"sm"},r.a.createElement(j.a,{icon:C.D})))),r.a.createElement(S.a,{xs:2,sm:1,md:1,ld:1,xl:1},r.a.createElement(y.a.Link,null,r.a.createElement(x.a,{onClick:this.handleDelete,variant:"secondary",size:"sm"},r.a.createElement(j.a,{icon:C.Q})))),r.a.createElement(S.a,{xs:1,sm:1,md:1,ld:1,xl:1},e&&"info"===e?r.a.createElement(x.a,{variant:"info",size:"sm",disabled:!0},r.a.createElement(ne.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})):"",e&&"danger"===e?r.a.createElement(x.a,{variant:"danger",size:"sm",disabled:!0},r.a.createElement(j.a,{icon:C.i})):"",e&&"success"===e?r.a.createElement(x.a,{variant:"success",size:"sm",disabled:!0},r.a.createElement(j.a,{icon:C.d})):"")),r.a.createElement(E.a,null,r.a.createElement(S.a,{xs:12,sm:12,md:12,ld:12,xl:12},r.a.createElement(y.a.Subtitle,{className:"mb-2 text-muted"},this.props.subtitle))),r.a.createElement(E.a,null,r.a.createElement(S.a,{xs:12,sm:12,md:12,ld:12,xl:12},this.props.sttEngine&&this.props.clipName&&r.a.createElement(re.a,null,r.a.createElement(re.a.Toggle,{as:x.a,variant:"link",eventKey:"0"},r.a.createElement(te.a,{variant:"light"},"Info")),r.a.createElement(re.a.Collapse,{eventKey:"0"},r.a.createElement(r.a.Fragment,null,this.props.sttEngine?r.a.createElement(r.a.Fragment,null,"STT Engine: ",r.a.createElement(te.a,{variant:"light"},this.props.sttEngine)):null,r.a.createElement("br",null),this.props.clipName?r.a.createElement(r.a.Fragment,null,"File Name: ",r.a.createElement(te.a,{variant:"light"},this.props.clipName)):null))))),t?r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,null,r.a.createElement(S.a,{xs:12,sm:12,md:12,ld:12,xl:12},t))):null)}}]),t}(n.Component),se=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleSearch=function(e){var t=a.props.items.filter((function(t){return console.log("transcript",t),P(t.title,e)||P(t.description,e)||P(t.clipName,e)||P(t.sttEngine,e)?(t.display=!0,t):(t.display=!1,t)}));a.props.handleUpdateList(t)},a.state={showSearchInput:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t,a,n=this;return this.props.items&&(e=this.props.items.map((function(e){return e.display?r.a.createElement(oe,{sttEngine:e.sttEngine,clipName:e.clipName,icon:n.props.icon,key:"key__"+e.id,id:e.id,projectId:e.id,title:e.title,subtitle:e.description,handleEdit:n.props.handleEdit,handleDelete:function(){n.props.handleDelete(e.id)},showLink:function(){return n.props.showLinkPath(e.id)},status:e.status,description:void 0,disabled:"done"===e.status,errorMessage:"error"===e.status?e.errorMessage:null}):null})).filter((function(e){return null!==e}))),null!==this.props.items&&0!==this.props.items.length&&(a=r.a.createElement(N,{handleSearch:this.handleSearch})),t=null!==this.props.items&&0!==this.props.items.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{style:{height:"75vh",overflow:"scroll"}},e)):r.a.createElement("i",null,"No ",this.props.model,", create a new one to get started "),r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,null,r.a.createElement(S.a,{xs:12,sm:6,md:7,lg:7,xl:7},a),"cep"!==X()?r.a.createElement(r.a.Fragment,null,r.a.createElement(S.a,{xs:12,sm:3,md:2,lg:2,xl:2},r.a.createElement(x.a,{onClick:this.props.handleShowCreateNewItemForm,variant:"secondary",size:"sm",block:!0},"New ",this.props.model)),r.a.createElement(S.a,{xs:12,sm:3,md:3,lg:3,xl:3},r.a.createElement(x.a,{onClick:this.props.handleShowCreateNewBatchForm,variant:"secondary",size:"sm",block:!0},"New Batch ",this.props.model,"s"))):r.a.createElement(S.a,{xs:12,sm:6,md:5,lg:5,xl:5},r.a.createElement(x.a,{onClick:this.props.handleShowCreateNewItemForm,variant:"secondary",size:"sm",block:!0},"New ",this.props.model))),t)}}]),t}(n.Component),ie=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleDismiss=function(){return a.setState({show:!1})},a.state={show:!0},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.state.show?r.a.createElement(ae.a,{variant:this.props.variant,onClose:this.handleDismiss,dismissible:!0},this.props.heading?r.a.createElement(ae.a.Heading,null,this.props.heading):"",this.props.message):r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null))}}]),t}(r.a.Component),ce=(a(175),a(37)),le=a.n(ce),pe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleTitleChange=function(e){a.setState({title:e.target.value})},a.handleDescriptionChange=function(e){a.setState({description:e.target.value})},a.handleAdobeCepSetFilePath=function(){window.__adobe_cep__.evalScript("$._PPP.get_current_project_panel_selection_absolute_path()",(function(e){console.log("handleAdobeCepSetFilePath"),""!==e?(console.log("handleAdobeCepSetFilePath",e),a.setState({title:le.a.basename(e),adobeCepFilePath:e})):alert("select a clip")}))},a.handleFileUpload=function(e){var t=Array.from(e.target.files)[0],n=new FormData;n.append("file",t),n.append("type",t.type),t.path&&n.append("path",t.path),a.setState({mediaFileSelected:!0,formData:n}),""===a.state.title&&a.setState({title:t.name})},a.sendRequest=function(){a.setState({uploading:!0});var e=a.state.formData;"cep"!==X()&&(e.append("title",a.state.title),e.append("description",a.state.description),console.log("formData.get('path')",e.get("path")));var t={};"electron"===X()&&(t={title:e.get("title"),description:e.get("description"),path:e.get("path")}),"cep"===X()&&(t={title:a.state.title,description:a.state.description,path:a.state.adobeCepFilePath});try{Q.createTranscript(a.state.projectId,a.state.formData,t).then((function(e){console.log("ApiWrapper.createTranscript-response ",e),a.setState({uploading:!1,uploadCompleted:!0,redirect:!0,newTranscriptId:e.transcriptId}),a.props.handleSaveForm(e.transcript)})).catch((function(e){console.log("error:::: ",e),a.setState({uploading:!1,redirect:!1,savedNotification:r.a.createElement(ie,{dismissable:!0,variant:"danger",heading:"Error could not contact the server",message:r.a.createElement("p",null,"There was an error trying to create this transcript on the server")})})}))}catch(n){console.error("error submitting:::",n)}},a.state={projectId:a.props.projectId,validated:!1,redirect:!1,newTranscriptId:null,uploading:!1,uploadCompleted:!1,mediaFileSelected:!1,title:a.props.title,description:a.props.description,id:a.props.id,formData:null,adobeCepFilePath:null,savedNotification:null},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleSubmit",value:function(e){var t=e.currentTarget;console.log("(form.checkValidity()",t.checkValidity()),t.checkValidity()||(e.preventDefault(),e.stopPropagation(),this.setState({validated:!0})),t.checkValidity()&&(e.preventDefault(),e.stopPropagation(),this.sendRequest())}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,this.state.savedNotification,r.a.createElement(D.a,{noValidate:!0,validated:this.state.validated,onSubmit:function(t){return e.handleSubmit(t)}},"cep"===X()?r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{variant:"light",onClick:this.handleAdobeCepSetFilePath,block:!0},"Pick a file"),r.a.createElement(D.a.Text,{className:"text-muted"},"Select an audio or video file to transcribe. Click on a file in the Adobe Premiere project browser window, and the click ",r.a.createElement("code",null,"pick a file")," to select a file to transcribe. Then click ",r.a.createElement("code",null,"save")," when you are ready to start the transcriptiion.")):r.a.createElement(D.a.Group,{controlId:"formTranscriptMediaFile"},r.a.createElement(D.a.Control,{required:!0,type:"file",label:"Upload",accept:"audio/*,video/*,.mxf",onChange:this.handleFileUpload}),r.a.createElement(D.a.Text,{className:"text-muted"},"Select an audio or video file to transcribe"),r.a.createElement(D.a.Control.Feedback,null,"Looks good!"),r.a.createElement(D.a.Control.Feedback,{type:"invalid"},"Please chose a audio or video file to transcribe")),r.a.createElement(D.a.Group,{controlId:"formTranscriptTitle"},r.a.createElement(D.a.Label,null,"Title "),r.a.createElement(D.a.Control,{required:!0,type:"text",placeholder:"Enter a transcript title",value:this.state.title,onChange:this.handleTitleChange}),r.a.createElement(D.a.Text,{className:"text-muted"},"Chose a title for your Transcript"),r.a.createElement(D.a.Control.Feedback,null,"Looks good!"),r.a.createElement(D.a.Control.Feedback,{type:"invalid"},"Please chose a title for your transcript")),r.a.createElement(D.a.Group,{controlId:"formTranscriptDescription"},r.a.createElement(D.a.Label,null,"Description "),r.a.createElement(D.a.Control,{type:"text",placeholder:"Enter a Transcript description",value:this.state.description,onChange:this.handleDescriptionChange}),r.a.createElement(D.a.Text,{className:"text-muted"},"Chose an optional description for your Transcript"),r.a.createElement(D.a.Control.Feedback,null,"Looks good!"),r.a.createElement(D.a.Control.Feedback,{type:"invalid"},"Please chose a description for your transcript")),r.a.createElement(A.a.Footer,null,r.a.createElement(x.a,{variant:"primary",type:"submit"},"Save"))))}}]),t}(n.Component),de=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleClose=function(){a.props.handleCloseModal()},a.state={title:"title"},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(A.a,{show:this.props.show,onHide:this.handleClose},r.a.createElement(A.a.Header,{closeButton:!0},r.a.createElement(A.a.Title,null,this.props.modalTitle)),r.a.createElement(A.a.Body,null,r.a.createElement(pe,{projectId:this.props.projectId,title:this.props.title,description:this.props.description,id:this.props.id,handleSaveForm:this.props.handleSaveForm,handleCloseModal:this.props.handleCloseModal})))}}]),t}(r.a.Component),ue=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleTitleChange=function(e){a.setState({title:e.target.value})},a.handleDescriptionChange=function(e){a.setState({description:e.target.value})},a.handleAdobeCepSetFilePath=function(){window.__adobe_cep__.evalScript("$._PPP.get_current_project_panel_selection_absolute_path()",(function(e){console.log("handleAdobeCepSetFilePath"),""!==e?(console.log("handleAdobeCepSetFilePath",e),a.setState({title:le.a.basename(e),adobeCepFilePath:e})):alert("select a clip")}))},a.handleFileUpload=function(e){var t=Array.from(e.target.files);console.log("files",t);var n=new FormData;t.forEach((function(e,t){n.append("file",e),n.append("type",e.type),e.path&&n.append("path",e.path)})),a.setState({mediaFileSelected:!0,formData:n})},a.sendRequest=function(){a.setState({uploading:!0});var e=a.state.formData.getAll("path"),t={};if("electron"===X()&&e.forEach((function(e){t={title:le.a.basename(e),description:"".concat(le.a.basename(e)),path:e};try{Q.createTranscript(a.state.projectId,a.state.formData,t).then((function(e){console.log("ApiWrapper.createTranscript-response ",e),a.setState({uploading:!1,uploadCompleted:!0,redirect:!0,newTranscriptId:e.transcriptId}),a.props.handleSaveForm(e.transcript)})).catch((function(e){console.log("error:::: ",e),a.setState({uploading:!1,redirect:!1,savedNotification:r.a.createElement(ie,{dismissable:!0,variant:"danger",heading:"Error could not contact the server",message:r.a.createElement("p",null,"There was an error trying to create this transcript on the server")})})}))}catch(n){console.error("error submitting:::",n)}})),"browser"===X()){var n=a.state.formData,o=n.getAll("file"),s=n.getAll("type");o.forEach((function(e,t){var n=new FormData;n.append("file",e),n.append("type",s[t]),n.append("title",e.name),n.append("description","");var o={title:e.name,description:""};try{Q.createTranscript(a.state.projectId,n,o).then((function(e){console.log("ApiWrapper.createTranscript-response ",e),a.setState({uploading:!1,uploadCompleted:!0,redirect:!0,newTranscriptId:e.transcriptId}),a.props.handleSaveForm(e.transcript)})).catch((function(e){console.log("error:::: ",e),a.setState({uploading:!1,redirect:!1,savedNotification:r.a.createElement(ie,{dismissable:!0,variant:"danger",heading:"Error could not contact the server",message:r.a.createElement("p",null,"There was an error trying to create this transcript on the server")})})}))}catch(i){console.error("error submitting:::",i)}}))}"cep"===X()&&alert("not implemented in adobe CEP")},a.state={projectId:a.props.projectId,validated:!1,redirect:!1,newTranscriptId:null,uploading:!1,uploadCompleted:!1,mediaFileSelected:!1,title:a.props.title,description:a.props.description,id:a.props.id,formData:null,adobeCepFilePath:null,savedNotification:null},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleSubmit",value:function(e){var t=e.currentTarget;console.log("form.checkValidity()",t.checkValidity()),t.checkValidity()||(e.preventDefault(),e.stopPropagation(),this.setState({validated:!0})),t.checkValidity()&&(e.preventDefault(),e.stopPropagation(),this.sendRequest())}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,this.state.savedNotification,r.a.createElement(D.a,{noValidate:!0,validated:this.state.validated,onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement(D.a.Group,{controlId:"formTranscriptMediaFile"},r.a.createElement(D.a.Label,null,"Select Files "),r.a.createElement(D.a.Control,{required:!0,type:"file",label:"Upload",accept:"audio/*,video/*,.mxf",multiple:"multiple",onChange:this.handleFileUpload}),r.a.createElement(D.a.Text,{className:"text-muted"},"Select multiple audio or video file to transcribe."),r.a.createElement(D.a.Text,{className:"text-muted"},"This allows you to batch transcribe multiple files, the transcript name will default to the clip name."),r.a.createElement(D.a.Text,{className:"text-muted"},"You can change the default transcript name after you've clicked save."),r.a.createElement(D.a.Text,{className:"text-muted"},"Use command ",r.a.createElement("code",null,"\u2318")," + click or  shift ",r.a.createElement("code",null,"\u21e7")," + click to select multiple files."),r.a.createElement(D.a.Control.Feedback,null,"Looks good!"),r.a.createElement(D.a.Control.Feedback,{type:"invalid"},"Please chose a audio or video file to transcribe")),r.a.createElement(A.a.Footer,null,r.a.createElement(x.a,{variant:"primary",type:"submit"},"Save"))))}}]),t}(n.Component),he=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleClose=function(){a.props.handleCloseModal()},a.state={title:"title"},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(A.a,{show:this.props.show,onHide:this.handleClose},r.a.createElement(A.a.Header,{closeButton:!0},r.a.createElement(A.a.Title,null,this.props.modalTitle)),r.a.createElement(A.a.Body,null,r.a.createElement(ue,{projectId:this.props.projectId,title:this.props.title,description:this.props.description,id:this.props.id,handleSaveForm:this.props.handleSaveForm,handleCloseModal:this.props.handleCloseModal})))}}]),t}(r.a.Component),me=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).componentWillUnmount=function(){a.interval&&clearInterval(a.interval)},a.getTranscripts=function(){var e,t;return f.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.a.awrap(Q.getTranscripts(a.state.projectId));case 2:(e=n.sent)&&(t=e.transcripts.map((function(e){return e.display=!0,e})),a.setState({projectTitle:e.projectTitle,items:t}));case 4:case"end":return n.stop()}}))},a.areThereTranscriptsInProgress=function(e){return 0!==e.length&&!!e.find((function(e){return"in-progress"===e.status}))},a.handleSaveItem=function(e){console.log("handleSaveItem",e);var t=e;t.display=!0;var n=a.state.items,r=Object(g.a)(n);r.push(t),a.setState({items:r,title:"",itemId:null,description:"",isNewItemModalShow:!1},(function(){console.log("setState")}))},a.handleSaveBatch=function(e){if(console.log("handleSaveBatch",e),a.setState({isNewBatchModalShow:!1}),e.length){var t=e.map((function(e){return e.display=!0,e})),n=a.state.items,r=Object(g.a)(n),o=[].concat(Object(g.a)(r),Object(g.a)(t));a.setState({items:o,title:"",itemId:null,description:"",isNewBatchModalShow:!1},(function(){console.log("setState - itemsProps.length",a.state.isNewBatchModalShow)}))}else{var s=e;s.display=!0;var i=a.state.items,c=Object(g.a)(i);c.push(s),a.setState({items:c,title:"",itemId:null,description:"",isNewItemModalShow:!1},(function(){console.log("setState - single",a.state.isNewBatchModalShow)}))}},a.handleSaveEditedItem=function(e){var t=e;console.log("newEditedITem",t),t.display=!0;var n=a.state.items,r=n.findIndex((function(t){return t.id===e.id})),o=Object(g.a)(n);e.status=o[r].status,o[r]=e;var s=t.id;Q.updateTranscript(a.state.projectId,s,!1,t).then((function(e){e.ok&&(console.log("ApiWrapper.updateTranscript",e,o),a.setState({items:o,isEditItemModalShow:!1}))}))},a.findItemById=function(e,t){return e.filter((function(e){return e.id===t}))[0]},a.handleEditItem=function(e){var t=a.findItemById(a.state.items,e);a.setState({title:t.title,itemId:t.id,description:t.description,isEditItemModalShow:!0})},a.showLinkPathToItem=function(e){return"/projects/".concat(a.state.projectId,"/transcripts/").concat(e,"/correct")},a.handleUpdateList=function(e){a.setState({items:e})},a.handleShowCreateNewItemForm=function(){a.setState({isNewItemModalShow:!0})},a.handleShowCreateNewBatchForm=function(){console.log("handleShowCreateNewBatchForm"),a.setState({isNewBatchModalShow:!0})},a.handleCloseModal=function(){a.setState({title:"",itemId:null,description:"",isNewItemModalShow:!1})},a.handleCloseBatchModal=function(){a.setState({title:"",itemId:null,description:"",isNewBatchModalShow:!1})},a.handleCloseModalEdit=function(){a.setState({title:"",itemId:null,description:"",isEditItemModalShow:!1})},a.handleUpdateList=function(e){a.setState({items:e,isNewItemModalShow:!1})},a.state={projectId:a.props.projectId,items:[],isNewItemModalShow:!1,isNewBatchModalShow:!1,title:"",description:"",itemId:null,projectTitle:"",isServerError:!1,isEditItemModalShow:!1},a.handleDelete=a.handleDelete.bind(Object(v.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;return f.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:this.getTranscripts(),this.interval=setInterval((function(){console.log("Running interval to check for transcripts"),e.areThereTranscriptsInProgress(e.state.items)&&(console.log("interval: checking transcirpt update"),e.getTranscripts())}),3e4);case 2:case"end":return t.stop()}}),null,this)}},{key:"handleDelete",value:function(e){var t,a,n;return f.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return console.log("handle delete"),r.next=3,f.a.awrap(Q.deleteTranscript(this.state.projectId,e));case 3:t=r.sent,a=function(t){return t.id!==e},t.ok&&(n=this.state.items.filter((function(e){return a(e)})),this.setState({items:n},(function(){console.log("deleted")})));case 6:case"end":return r.stop()}}),null,this)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{style:{marginBottom:"5em",marginTop:"1em"}},r.a.createElement(se,{model:"Transcript",items:this.state.items,handleShowCreateNewItemForm:this.handleShowCreateNewItemForm,handleShowCreateNewBatchForm:this.handleShowCreateNewBatchForm,handleEdit:this.handleEditItem,handleDelete:this.handleDelete,showLinkPath:this.showLinkPathToItem,handleUpdateList:this.handleUpdateList,handleCloseModal:this.handleCloseModal,handleCloseBatchModal:this.handleCloseBatchModal,icon:r.a.createElement(j.a,{icon:C.l,color:"#007bff"})}),r.a.createElement(de,{projectId:this.state.projectId,title:this.state.title,description:this.state.description,id:this.state.itemId,modalTitle:"New Transcript",show:this.state.isNewItemModalShow,handleCloseModal:this.handleCloseModal,handleSaveForm:this.handleSaveItem}),r.a.createElement(he,{projectId:this.state.projectId,title:this.state.title,description:this.state.description,id:this.state.itemId,modalTitle:"New Batch Transcripts",show:this.state.isNewBatchModalShow,handleCloseModal:this.handleCloseBatchModal,handleSaveForm:this.handleSaveBatch}),r.a.createElement(U,{title:this.state.title,description:this.state.description,id:this.state.itemId,modalTitle:"Edit Transcript",show:this.state.isEditItemModalShow,handleCloseModal:this.handleCloseModalEdit,handleSaveForm:this.handleSaveEditedItem})))}}]),t}(n.Component),fe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleSaveItem=function(e){e.id?Q.updatePaperEdit(a.state.projectId,e.id,e).then((function(t){if("ok"===t.status){var n=t.paperedit;n.display=!0;var r=a.state.items,o=Object(g.a)(r);a.findItemById(r,e),o[r.findIndex((function(e){return e.id===n.id}))]=n,a.setState({isNewItemModalShow:!1,items:o,title:"",itemId:null,description:""})}})):Q.createPaperEdit(a.state.projectId,e).then((function(e){if("ok"===e.status){var t=Object(g.a)(a.state.items);e.paperedit.display=!0,t.push(e.paperedit),a.setState({isNewItemModalShow:!1,items:t,title:"",itemId:null,description:""})}}))},a.findItemById=function(e,t){return e.filter((function(e){return e.id===t}))[0]},a.handleEditItem=function(e){var t=a.findItemById(a.state.items,e);a.setState({title:t.title,itemId:t.id,description:t.description,isNewItemModalShow:!0})},a.showLinkPathToItem=function(e){return"/projects/".concat(a.state.projectId,"/paperedits/").concat(e)},a.handleUpdateList=function(e){a.setState({items:e})},a.handleShowCreateNewItemForm=function(){a.setState({isNewItemModalShow:!0})},a.handleCloseModal=function(){a.setState({title:"",itemId:null,description:"",isNewItemModalShow:!1})},a.state={projectId:a.props.projectId,items:[],isNewItemModalShow:!1,title:"",description:"",itemId:null},a.handleDeleteItem=a.handleDeleteItem.bind(Object(v.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e,t;return f.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f.a.awrap(Q.getAllPaperEdits(this.state.projectId));case 2:(e=a.sent)&&(t=e.map((function(e){return e.display=!0,e})),this.setState({items:t}));case 4:case"end":return a.stop()}}),null,this)}},{key:"handleDeleteItem",value:function(e){var t;return f.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f.a.awrap(Q.deletePaperEdit(this.state.projectId,e));case 2:a.sent.ok&&(t=this.state.items.filter((function(t){return t.id!==e})),this.setState({items:t}));case 4:case"end":return a.stop()}}),null,this)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{style:{marginBottom:"5em",marginTop:"1em"}},r.a.createElement(F,{model:"Paper Edit",items:this.state.items,icon:r.a.createElement(j.a,{icon:C.h,color:"#007bff"}),handleShowCreateNewItemForm:this.handleShowCreateNewItemForm,handleEdit:this.handleEditItem,handleDelete:this.handleDeleteItem,showLinkPath:this.showLinkPathToItem,handleUpdateList:this.handleUpdateList}),r.a.createElement(U,{title:this.state.title,description:this.state.description,id:this.state.itemId,modalTitle:this.state.itemId?"Edit Paper Edit":"New Paper Edit",show:this.state.isNewItemModalShow,handleCloseModal:this.handleCloseModal,handleSaveForm:this.handleSaveItem})))}}]),t}(n.Component),ge=function(e){function t(e,a){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(p.a)(t).call(this,e,a))).state={key:"transcripts",projectId:n.props.match.params.projectId,projectName:"Projects Name"},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e;return f.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.a.awrap(Q.getProject(this.state.projectId));case 2:(e=t.sent)&&this.setState({projectName:e.project.title});case 4:case"end":return t.stop()}}),null,this)}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{style:{marginBottom:"5em",marginTop:"1em"}},r.a.createElement(E.a,null,r.a.createElement(S.a,{sm:12,md:12,ld:12,xl:12},r.a.createElement(_,{items:[{name:"Projects",link:"/projects"},{name:this.state.projectName}]}))),r.a.createElement(Z.a,{id:"controlled-tab-example",activeKey:this.state.key,onSelect:function(t){return e.setState({key:t})}},r.a.createElement(ee.a,{eventKey:"transcripts",title:"Transcripts"},r.a.createElement(me,{projectId:this.state.projectId})),r.a.createElement(ee.a,{eventKey:"paperedits",title:"Paper Edits"},r.a.createElement(fe,{projectId:this.state.projectId})))))}}]),t}(r.a.Component),ve=a(59),be=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).componentDidMount=function(){Q.getTranscript(a.state.projectId,a.state.transcriptId).then((function(e){console.log("json",e),a.setState({projectTitle:e.projectTitle,transcriptTitle:e.transcriptTitle,transcriptJson:e.transcript,url:e.url,clipName:e.clipName})}))},a.handleSave=function(e){console.log("handleSave",e);var t=e;t.title=a.state.transcriptTitle,t.transcriptTitle=a.state.transcriptTitle;Q.updateTranscript(a.state.projectId,a.state.transcriptId,!1,t).then((function(e){console.log("ApiWrapper.updateTranscript",e),e.ok&&(console.log("updated"),a.setState({savedNotification:r.a.createElement("small",{className:"text-success"},"Transcript: ",r.a.createElement("b",null,a.state.transcriptTitle)," has been saved at ",r.a.createElement("b",null,(new Date).toLocaleString()))}))})).catch((function(e){console.error("error saving transcript:: ",e),a.setState({savedNotification:r.a.createElement(ie,{dismissable:!0,variant:"danger",heading:"Error saving transcript",message:r.a.createElement("p",null,"There was an error trying to save this transcript: ",r.a.createElement("b",null,a.state.transcriptTitle))})})}))},a.redirectToAnnotatePage=function(){a.setState({redirect:!0})},a.renderRedirect=function(){if(a.state.redirect)return r.a.createElement(h.c,{to:"/projects/".concat(a.state.projectId,"/transcripts/").concat(a.state.newTranscriptId,"/annotate")})},a.state={projectId:a.props.match.params.projectId,transcriptId:a.props.match.params.transcriptId,transcriptJson:null,url:null,projectTitle:"",transcriptTitle:"",savedNotification:null},a.transcriptEditorRef=r.a.createRef(),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e="video";return".wav"!==le.a.extname(this.state.clipName)&&".mp3"!==le.a.extname(this.state.clipName)&&".m4a"!==le.a.extname(this.state.clipName)&&".flac"!==le.a.extname(this.state.clipName)&&".aiff"!==le.a.extname(this.state.clipName)||(e="audio"),r.a.createElement(r.a.Fragment,null,this.renderRedirect(),r.a.createElement(b.a,{style:{backgroundColor:"#eee"},fluid:!0},r.a.createElement("br",null),r.a.createElement(E.a,null,r.a.createElement(S.a,{sm:12,md:12,ld:12,xl:12,style:{marginBottom:"0"}},r.a.createElement(_,{backgroundColor:"transparent",items:[{name:"Projects",link:"/projects"},{name:"Project: ".concat(this.state.projectTitle),link:"/projects/".concat(this.state.projectId)},{name:"Transcripts"},{name:"".concat(this.state.transcriptTitle)}]}))),this.state.savedNotification,null!==this.state.transcriptJson&&r.a.createElement(ve.a,{transcriptData:this.state.transcriptJson,mediaUrl:this.state.url,isEditable:!0,title:this.state.transcriptTitle,mediaType:e,autoSaveContentType:"digitalpaperedit",handleSaveEditor:this.handleSave})))}}]),t}(n.Component),Ee=a(45),Se=a(90),we=a(34),ye=a(102),xe=a(83),ke=a(24),je={control:function(e){return Object(ke.a)({},e,{backgroundColor:"white"})},option:function(e,t){var a=t.data,n=t.isDisabled,r=(t.isFocused,t.isSelected,a.color);return Object(ke.a)({},e,{backgroundColor:null,borderLeft:"1.5em solid",borderColor:r,marginBottom:"0.4em",cursor:n?"not-allowed":"default"})},multiValue:function(e,t){var a=t.data;return Object(ke.a)({},e,{backgroundColor:"white",border:"0.05em solid",borderLeft:"1.2em solid",borderColor:a.color})},multiValueLabel:function(e,t){t.data;return Object(ke.a)({},e)},multiValueRemove:function(e,t){t.data;return Object(ke.a)({},e)}},Ce={control:function(e){return Object(ke.a)({},e,{backgroundColor:"white"})},option:function(e){return Object(ke.a)({},e,{backgroundColor:null,cursor:"default"})},multiValue:function(e){return Object(ke.a)({},e,{backgroundColor:"white",border:"0.05em solid grey"})},multiValueLabel:function(e){return Object(ke.a)({},e)},multiValueRemove:function(e){return Object(ke.a)({},e)}},Oe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleSpeakersSearchChange=function(e){a.props.handleSpeakersSearchChange(e),a.setState({selectedOptionSpeakerSearch:e})},a.handleLabelsSearchChange=function(e){a.props.handleLabelsSearchChange(e),a.setState({selectedOptionLabelSearch:e})},a.handleShowParagraphsMatchingSearch=function(){a.setState((function(e){return a.props.handleShowParagraphsMatchingSearch(!e.showParagraphsMatchingSearch),{showParagraphsMatchingSearch:!e.showParagraphsMatchingSearch}}),(function(){}))},a.handleFilterResults=function(){a.setState((function(e){return e.isShowingFilterOptions?(a.props.handleShowParagraphsMatchingSearch(!1),{isShowingFilterOptions:!1,showTextSearchPreferences:!1,showSpeakersSearchPreferences:!1,showLabelsSearchPreferences:!1,showParagraphsMatchingSearch:!1}):(a.props.handleShowParagraphsMatchingSearch(!0),{isShowingFilterOptions:!0,showTextSearchPreferences:!0,showSpeakersSearchPreferences:!0,showLabelsSearchPreferences:!0,showParagraphsMatchingSearch:!0})}))},a.state={isShowingFilterOptions:!1,showParagraphsMatchingSearch:!1,showTextSearchPreferences:!1,showSpeakersSearchPreferences:!1,showLabelsSearchPreferences:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(I.a,{className:"mb-3"},r.a.createElement(I.a.Prepend,null,r.a.createElement(I.a.Text,null,r.a.createElement(j.a,{icon:C.H}))),r.a.createElement(L.a,{onChange:function(t){e.props.handleSearch(t,{showParagraphsMatchingSearch:e.state.showParagraphsMatchingSearch,showLabelsSearchPreferences:e.state.showLabelsSearchPreferences,showSpeakersSearchPreferences:e.state.showSpeakersSearchPreferences})},placeholder:"Search text...","aria-label":"search","aria-describedby":"search"}),r.a.createElement(I.a.Append,null,r.a.createElement(I.a.Text,{style:{cursor:"pointer"},onClick:this.handleFilterResults},r.a.createElement(j.a,{icon:C.q,title:"Filter results"})))),this.state.showLabelsSearchPreferences?r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{className:"mb-3"},r.a.createElement(S.a,{xs:1,sm:1,md:1,ld:1,xl:1},r.a.createElement(I.a.Prepend,null,r.a.createElement(I.a.Text,null,r.a.createElement(j.a,{icon:C.N})))),r.a.createElement(S.a,{xs:10,sm:11,md:11,ld:11,xl:11},r.a.createElement(xe.a,{value:this.state.selectedOptionLabelSearch,onChange:this.handleLabelsSearchChange,isMulti:!0,isSearchable:!0,options:this.props.labelsOptions,styles:je,placeholder:"Filter by labels..."})))):"",this.state.showSpeakersSearchPreferences?r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{className:"mb-3"},r.a.createElement(S.a,{xs:1,sm:1,md:1,ld:1,xl:1},r.a.createElement(I.a.Prepend,null,r.a.createElement(I.a.Text,null,r.a.createElement(j.a,{icon:C.T})))),r.a.createElement(S.a,{xs:10,sm:11,md:11,ld:11,xl:11},r.a.createElement(xe.a,{value:this.state.selectedOptionSpeakerSearch,onChange:this.handleSpeakersSearchChange,isMulti:!0,isSearchable:!0,options:this.props.speakersOptions,styles:Ce,placeholder:"Filter by speakers..."})))):"",this.state.showTextSearchPreferences?r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a.Check,{type:"checkbox",checked:this.state.showParagraphsMatchingSearch,onChange:this.handleShowParagraphsMatchingSearch,label:r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a.Text,{className:"text-muted",title:"Show only matching paragraphs",onClick:this.handleShowParagraphsMatchingSearch},"Show only matching paragraphs"))})):"")}}]),t}(n.Component);var Te=function(e,t){return function(e,t){var a=[],n=0,r=0,o={words:[],text:"",speaker:""};return e.forEach((function(e){var s=function(e,t){return t.find((function(t){if(e.start>=t.start&&e.end<=t.end)return t}))}(e,t);void 0!==s&&((n=t.indexOf(s))===r?(o.words.push(e),o.text+=e.text+" ",o.speaker=s.speaker):(r=n,o.text.trim(),a.push(o),(o={words:[],text:"",speaker:""}).words.push(e),o.text+=e.text+" ",o.speaker=s.speaker))})),a.push(o),a}(e,t)},Pe=function(e,t){var a=t[0].start,n=t[t.length-1].end,r=function(e,t,a){return e.find((function(e){return e.start>=t&&e.end<=a}))}(e,a,n);if(r)return r;var o=function(e,t,a){return e.find((function(e){return e.start>=t&&e.start<=a}))}(e,a,n);if(o)return o;var s=function(e,t,a){return e.find((function(e){return e.end>=t&&e.end<=a}))}(e,a,n);if(s)return s;var i=function(e,t,a){return e.find((function(e){return e.start<=t&&e.end>=a}))}(e,a,n);return i||!1},Ie=a(171),Le=a.n(Ie),Ne=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.paragraphDisplayPreference;e.borderStyle="dashed",e.borderWidth="0.01em",e.borderColor="lightgray",e.padding="0.5em";var t={};return this.props.showParagraphsMatchingSearch?t=this.props.paragraphDisplayPreference:e.display||(delete e.display,t.borderRight="0.1em dashed lightgrey",t.borderLeft="0.1em dashed lightgrey"),r.a.createElement(E.a,{style:Object(ke.a)({},t),className:"paragraph","data-paragraph-text":this.props.paragraphTextWithoutPunctuation},r.a.createElement(S.a,{xs:12,sm:12,md:3,lg:3,xl:2,style:{cursor:"pointer",width:"100%"},className:"text-truncate",title:"".concat(this.props.speakerName.toUpperCase()," -  ").concat(Object(ve.b)(this.props.paragraph[0].start)," | Click on a speaker to jump to the corresponding time in the media.")},r.a.createElement("span",{className:[Le.a.speaker,Le.a.unselectable,"timecode"].join(" "),"data-start":this.props.paragraph[0].start,tabIndex:"0"},this.props.speakerName)),r.a.createElement(S.a,{xs:12,sm:12,md:9,lg:9,xl:10},this.props.wordsElements))}}]),t}(n.Component),Fe=function(e){return e.replace(/\.|\?|!|,|;/,"").toLowerCase()},Ae=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).generatePreviousTimes=function(e){for(var t="",a=0;a<e;a++)t+="".concat(a," ");if(e%1>0){var n=Math.floor(e%1*4)/4;t+=" ".concat(Math.floor(e)+n)}return t},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.transcriptId,a=e.speaker,n=e.word;return r.a.createElement("span",{style:{cursor:"pointer"},title:"start:".concat(Object(ve.b)(n.start)," - end:").concat(Object(ve.b)(n.end)," | Double click on a word to jump to the corresponding time in the media."),"data-prev-times":this.generatePreviousTimes(n.start),className:["words"].join(" "),"data-start":n.start,"data-text":Fe(n.text),"data-end":n.end,"data-transcript-id":t,"data-speaker":a,key:"key_"+n.id+"_"+n.end,role:"button","aria-pressed":"false",onKeyDown:this.props.handleKeyDownWords},n.text," ")}}]),t}(n.Component),De=a(240),Me=a(60),Ue=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleEditAnnotation=function(){a.props.handleEditAnnotation(a.props.annotationId,void 0)},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t=this;if(this.props.labelsOptions){var a=this.props.labelsOptions.find((function(e){return e.id===t.props.annotationLabelId}));a||(a=this.props.labelsOptions[0]),e=r.a.createElement(Me.a,{rootClose:!0,trigger:"click",placement:"bottom",overlay:r.a.createElement(De.a,{id:"popover-basic",style:{padding:"1em"}},r.a.createElement(E.a,null,r.a.createElement(S.a,{md:1,style:{backgroundColor:a.color,marginLeft:"1em"}}),r.a.createElement(S.a,null,r.a.createElement(j.a,{icon:C.N}),"  ",a.label),r.a.createElement(S.a,{md:1,style:{marginRight:"1em"},onClick:function(){t.props.handleDeleteAnnotation(t.props.annotationId)}},r.a.createElement(j.a,{icon:C.R}))),r.a.createElement("hr",null),r.a.createElement(j.a,{icon:C.J,onClick:this.handleEditAnnotation}),"   ",this.props.annotationNote,r.a.createElement("br",null),r.a.createElement(j.a,{icon:C.D,onClick:this.handleEditAnnotation}))},r.a.createElement("span",{style:{borderBottom:"0.1em ".concat(a.color," solid")},className:"highlight"},this.props.words))}return r.a.createElement(r.a.Fragment,null,e)}}]),t}(n.Component);var Be=function(e,t,a){var n={};return e||(n={display:"none"}),t||(n={display:"none"}),a||(n={display:"none"}),n},_e=function(e,t){return e.map((function(e){return e.words=function(e,t){return e.map((function(e){var a=function(e,t,a){return e.find((function(e){return t>=e.start&&a<=e.end}))}(t,e.start,e.end);return a?e.annotation=a:delete e.annotation,e}))}(e.words,t),e}))},Re=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleKeyDownTimecodes=function(e){"Enter"===e.key&&a.props.handleTimecodeClick(e)},a.handleKeyDownWords=function(e){"Enter"===e.key&&a.props.handleWordClick(e)},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t=this,a={},n=Te(this.props.transcriptJson.words,this.props.transcriptJson.paragraphs),o=_e(n,this.props.annotations).map((function(n,o){var s=Pe(t.props.annotations,n.words),i=n.text.replace(/\.|\?|!|,|;/,"").toLowerCase(),c=i.includes(t.props.searchString.toLowerCase()),l=!1;0!==t.props.selectedOptionSpeakerSearch.length?t.props.selectedOptionSpeakerSearch.find((function(e){return e.label===n.speaker}))&&(l=!0):l=!0;var p=!1;return 0!==t.props.selectedOptionLabelSearch.length?t.props.selectedOptionLabelSearch.find((function(e){return e.id===s.labelId}))&&(p=!0):p=!0,a=Be(c,l,p),e=n.words.map((function(e,a){var o=r.a.createElement(Ae,{transcriptId:t.props.transcriptId,speaker:n.speaker,key:"key--"+a,word:e,handleKeyDownWords:function(e){return"Enter"===e.key?t.props.handleWordClick(e):null}});return e.annotation?r.a.createElement(Ue,{key:"key----"+a,words:o,labelsOptions:t.props.labelsOptions,annotationLabelId:e.annotation.labelId,annotationId:e.annotation.id,annotationNote:e.annotation.note,handleDeleteAnnotation:t.props.handleDeleteAnnotation,handleEditAnnotation:t.props.handleEditAnnotation}):o})),r.a.createElement(Ne,{showParagraphsMatchingSearch:t.props.showParagraphsMatchingSearch,paragraphDisplayPreference:a,key:"key------"+o,paragraphTextWithoutPunctuation:i,speakerName:n.speaker,paragraph:n.words,handleKeyDownTimecodes:function(e){return"Enter"===e.key?t.props.handleTimecodeClick(e):null},wordsElements:e})}));return r.a.createElement(r.a.Fragment,null,o)}}]),t}(n.Component),We=a(91),Je=a.n(We),Ve=a(6),qe={yellow:"#ffff00",greenyellow:"#adff2f",deepskyblue:"#00bfff",deeppink:"#ff1493",aqua:"#00ffff",black:"#000000",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chocolate:"#d2691e",coral:"#ff7f50",crimson:"#dc143c",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",blue:"#0000ff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",chartreuse:"#7fff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",yellowgreen:"#9acd32",aquamarine:"#7fffd4",mediumaquamarine:"#66cdaa"},ze=Object.freeze(Object.keys(qe).splice(0,15)),He=[];for(var Ke in qe)He.push({value:Ke,label:Ke,color:qe[Ke]});var Ge=-1,Xe=ze.length,Ye=function(){return Ge<Xe?Ge+=1:Ge=0,ze[Ge]},Qe=a(230);var $e=function(e){var t=Object(n.useState)(e.color),a=Object(Ve.a)(t,2),o=a[0],s=a[1],i=function(t){console.log("handleSetColor",t),s(t),e.handleColorSelectChange(t)};return r.a.createElement(D.a.Group,{controlId:"formGroupPassword"},r.a.createElement(D.a.Label,null,"Color"),r.a.createElement(E.a,null,r.a.createElement(S.a,{xs:2,sm:1,md:1,lg:1,xl:1},r.a.createElement(x.a,{onClick:function(){var e=Ye();i(e)},variant:"light",size:"sm"},r.a.createElement(j.a,{icon:C.M}))),r.a.createElement(S.a,{xs:6,sm:6,md:6,lg:6,xl:6},r.a.createElement(D.a.Control,{value:o,type:"text",placeholder:"#",onChange:function(e){if(e&&e.target&&e.target.value){var t=e.target.value,a=Je.a.valid(t)?Je()(t).name():t;i(a)}else e&&e.target&&""===e.target.value&&i("")}})),r.a.createElement(S.a,{xs:2,sm:2,md:2,lg:2,xl:2,style:{backgroundColor:o,border:"solid",borderWidth:"0.01em",borderColor:"grey",padding:"1em"}})),r.a.createElement(E.a,null,r.a.createElement(S.a,{xs:12,sm:12,md:12,lg:12,xl:12},r.a.createElement(D.a.Text,{className:"text-muted"},"To pick a color you can chose one at random, pick one form the list below, or type the name or hex code above."),r.a.createElement(Qe.GithubPicker,{width:"100%",color:o,triangle:"hide",onChangeComplete:function(e){var t=Je()(e.hex).name();i(t)},colors:ze}))))},Ze=function(e){function t(e,a){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(p.a)(t).call(this,e,a))).handleColorSelectChange=function(e){n.setState({color:e})},n.handleSave=function(){Je.a.valid(n.state.color)?""!==n.state.label?(n.props.onLabelSaved({value:n.state.color,label:n.state.label,color:n.state.color,description:n.state.description,id:n.state.labelId}),n.props.handleClose()):alert("add a name to the label to be able to save"):alert("choose a valid color")},n.state={color:n.props.color,label:n.props.label,description:n.props.description,labelId:n.props.labelId},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,null,r.a.createElement(D.a.Group,{controlId:"formGroupEmail"},r.a.createElement(D.a.Label,null,"Label Name "),r.a.createElement(D.a.Control,{type:"text",placeholder:"Enter label name",defaultValue:this.state.label,onInput:function(t){e.setState({label:t.target.value})}}),r.a.createElement(D.a.Text,{className:"text-muted"},"Required label name")),r.a.createElement(D.a.Group,{controlId:"formGroupPassword"},r.a.createElement(D.a.Label,null,"Label Description"),r.a.createElement(D.a.Control,{type:"text",placeholder:"Enter label description",defaultValue:this.state.description,as:"textarea",rows:"3",onInput:function(t){e.setState({description:t.target.value})}}),r.a.createElement(D.a.Text,{className:"text-muted"},"Optional label description")),r.a.createElement($e,{color:this.props.color,handleColorSelectChange:this.handleColorSelectChange}),r.a.createElement(x.a,{variant:"primary",onClick:this.handleSave},"Save")))}}]),t}(n.Component),et=function(e){function t(e,a){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(p.a)(t).call(this,e,a))).handleClose=function(){n.setState({show:!1})},n.handleShow=function(){n.setState({show:!0})},n.state={show:!1,color:n.props.color,label:n.props.label,description:n.props.description,labelId:n.props.labelId},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{variant:"link",onClick:this.handleShow,block:!0},this.props.openBtn),r.a.createElement(A.a,{show:this.state.show,onHide:this.handleClose},r.a.createElement(A.a.Header,{closeButton:!0},r.a.createElement(A.a.Title,null,r.a.createElement(j.a,{icon:C.N}),"  Label ")),r.a.createElement(A.a.Body,null,r.a.createElement(Ze,{onLabelSaved:this.props.onLabelSaved,label:this.props.label,description:this.props.description,color:this.props.color,labelId:this.props.labelId,handleClose:this.handleClose}))))}}]),t}(n.Component),tt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).removeLabel=function(e,t){!0===confirm("Click OK to delete the label, Cancel if you changed your mind")?a.props.onLabelDelete(e):alert("Your label was not deleted")},a.editLabel=function(e,t){var n=a.props.labelsOptions.filter((function(t){return t.id===e}));console.log("labelToEdit",n)},a.onLabelSaved=function(e){e.id?a.props.onLabelUpdate(e):a.props.onLabelCreate(e)},a.showLabelModal=function(){console.log(a.state.isLabelmodalShown),a.setState((function(e){return{isLabelmodalShown:!e.isLabelmodalShown}}))},a.state={isLabelmodalShown:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t=this;this.props.labelsOptions&&(e=this.props.labelsOptions.map((function(e,a){return r.a.createElement(w.a.Item,{style:{width:"100%"},key:"label_"+a},r.a.createElement(E.a,null,r.a.createElement(S.a,{xs:1,sm:1,md:1,lg:1,xl:1,style:{backgroundColor:e.color},title:e.label}),r.a.createElement(S.a,{xs:6,sm:6,md:6,lg:6,xl:6,title:e.label},e.label),r.a.createElement(S.a,{xs:1,sm:2,md:2,lg:2,xl:2},"default"!==e.label.toLowerCase()?r.a.createElement(et,{color:e.color,label:e.label,description:e.description,labelId:e.id,show:t.state.isLabelmodalShown,onLabelSaved:t.onLabelSaved,openBtn:r.a.createElement("span",null,r.a.createElement(j.a,{icon:C.D}))}):r.a.createElement(x.a,{title:"edit label",variant:"link",size:"sm",disabled:!0},r.a.createElement(j.a,{icon:C.D}))),r.a.createElement(S.a,{xs:1,sm:2,md:2,lg:2,xl:2},r.a.createElement(x.a,{title:"delete label",variant:"link",size:"sm",onClick:function(a){t.removeLabel(e.id,a)},disabled:"default"===e.label.toLowerCase()},r.a.createElement(j.a,{icon:C.P})))),r.a.createElement(E.a,null,r.a.createElement(S.a,{xs:1,sm:1,md:1,lg:1,xl:1,className:"text-truncate",title:e.label}),r.a.createElement(S.a,{xs:10,sm:10,md:10,lg:10,xl:10},r.a.createElement(D.a.Text,{title:e.description},e.description))))})));var a=r.a.createElement(w.a,{style:{height:"50vh",width:"20vw",overflowY:"scroll",overflowX:"hidden"}},e);return r.a.createElement(r.a.Fragment,null,this.props.isLabelsListOpen?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement(y.a.Body,null,r.a.createElement(j.a,{icon:C.O})," ",r.a.createElement(j.a,{icon:C.g})," Labels"),a,r.a.createElement(y.a.Body,{className:"text-muted"},r.a.createElement(et,{color:Ye(),label:"",description:"",labelId:null,show:this.state.isLabelmodalShown,onLabelSaved:this.onLabelSaved,openBtn:r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{icon:C.N})," Create New Label")})))):"")}}]),t}(n.Component),at=function(e,t){var a;return function(){var n=arguments;clearTimeout(a),a=setTimeout((function(){e.apply(null,n)}),t)}};var nt=function(e){if(!window.getSelection().isCollapsed){var t=window.getSelection().getRangeAt(0).cloneContents().querySelectorAll(".words");if(0!==t.length)return{start:parseFloat(t[0].dataset.start),end:parseFloat(t[t.length-1].dataset.end)};var a=window.getSelection().anchorNode.parentElement;return"words"===a.className&&{start:parseFloat(a.dataset.start),end:parseFloat(a.dataset.end)}}return!1};var rt=function(e){var t=[],a=new Map,n=!0,r=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var c=s.value;a.has(c.speaker)||(a.set(c.speaker,!0),t.push({value:c.speaker,label:c.speaker}))}}catch(l){r=!0,o=l}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}return t},ot=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).componentDidMount=function(){Q.getAllAnnotations(a.props.projectId,a.props.transcriptId).then((function(e){a.setState({annotations:e.annotations})}))},a.handleLoadTranscription=function(){a.setState({componentMounted:!0})},a.onLabelCreate=function(e){Q.createLabel(a.props.projectId,e).then((function(e){a.setState({labelsOptions:e.labels})}))},a.onLabelUpdate=function(e){console.log("updatedLabel",e),Q.updateLabel(a.props.projectId,e.id,e).then((function(e){a.setState({labelsOptions:e.labels})}))},a.onLabelDelete=function(e){Q.deleteLabel(a.props.projectId,e).then((function(e){a.setState({labelsOptions:e.labels})}))},a.handleTimecodeClick=function(e){if(e.target.classList.contains("timecode")){var t=e.target;a.videoRef.current.currentTime=t.dataset.start,a.videoRef.current.play()}},a.handleWordClick=function(e){if("words"===e.target.className){var t=e.target;a.videoRef.current.currentTime=t.dataset.start,a.videoRef.current.play()}},a.handleShowParagraphsMatchingSearch=function(e){a.setState({showParagraphsMatchingSearch:e})},a.handleLabelsSearchChange=function(e){a.setState({selectedOptionLabelSearch:e})},a.handleSpeakersSearchChange=function(e){a.setState({selectedOptionSpeakerSearch:e})},a.handleSearch=function(e,t){if(""!==e.target.value){var n=e.target.value;a.setState({searchString:n.toLowerCase()}),at(a.highlightWords(n),500)}else""===e.target.value&&a.setState({sentenceToSearchCSS:"",searchString:""})},a.highlightWords=function(e){var t=e.toLowerCase().trim().split(" "),n='.paragraph[data-paragraph-text*="'.concat(t.join(" "),'"]'),r=t.map((function(e,a){var r="".concat(n,' > div > span.words[data-text="').concat(e.toLowerCase().trim(),'"]');return a<t.length-1&&(r+=", "),r})),o=t.map((function(e,a){var r="".concat(n,' > div  > span >span.words[data-text="').concat(e.toLowerCase().trim(),'"]');return a<t.length-1&&(r+=", "),r}));a.setState({sentenceToSearchCSS:r.join(" "),sentenceToSearchCSSInHighlights:o.join(" ")})},a.handleCreateAnnotation=function(e){var t=e.target,n=nt();if(n){var r=a.state.annotations;n.labelId=t.dataset.labelId,n.note="";var o=n;console.log("newAnnotation",o),Q.createAnnotation(a.props.projectId,a.props.transcriptId,o).then((function(e){var t=e.annotation;console.log("newAnnotationFromServer",t);var n=JSON.parse(JSON.stringify(r));n.push(t),a.setState({annotations:n})}))}else alert("Select some text in the transcript to highlight ")},a.handleDeleteAnnotation=function(e){var t=a.state.annotations.filter((function(t){return t.id!==e})),n=JSON.parse(JSON.stringify(t));Q.deleteAnnotation(a.props.projectId,a.props.transcriptId,e).then((function(e){a.setState({annotations:n})}))},a.handleEditAnnotation=function(e){var t=a.state.annotations,n=t.find((function(t){return t.id===e})),r=prompt("Edit the text note of the annotation",n.note);r?(n.note=r,Q.updateAnnotation(a.state.projectId,a.props.transcriptId,e,n).then((function(n){var r=n.annotation,o=t.filter((function(t){return t.id!==e}));o.push(r),a.setState({annotations:o})}))):alert("all good nothing changed")},a.getCurrentWordTime=function(){var e=a.props.transcript.words,t=a.state.currentTime,n=e.find((function(e){if(t>=e.start&&t<=e.end)return e.start}));return void 0!==n?n[0]:0},a.videoRef=r.a.createRef(),a.state={searchString:"",showParagraphsMatchingSearch:!1,selectedOptionLabelSearch:!1,selectedOptionSpeakerSearch:[],sentenceToSearchCSS:"",sentenceToSearchCSSInHighlights:"",annotations:[],isLabelsListOpen:!0,labelsOptions:a.props.labelsOptions,currentTime:0,componentMounted:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.state.currentTime,a=Math.round(4*t)/4,n=r.a.createElement("style",{scoped:!0},'span.words[data-prev-times~="'.concat(Math.floor(a),'"][data-transcript-id="').concat(this.props.transcriptId,'"] { color: ').concat("grey"," }"));return r.a.createElement(r.a.Fragment,null,r.a.createElement("style",{scoped:!0},"".concat(this.state.sentenceToSearchCSS," { background-color: ","yellow","; text-shadow: 0 0 0.01px black }"),"".concat(this.state.sentenceToSearchCSSInHighlights," { background-color: ","yellow","; text-shadow: 0 0 0.01px black }")),r.a.createElement(y.a,{style:{}},r.a.createElement(y.a.Body,{style:{backgroundColor:"black",padding:"0px"}},this.state.componentMounted&&r.a.createElement("video",{src:this.props.url,ref:this.videoRef,onTimeUpdate:function(t){e.setState({currentTime:t.target.currentTime})},style:{width:"100%",height:"10em",marginTop:"0em",backgroundColor:"black",boxShadow:"none"},controls:!0})),r.a.createElement(y.a.Body,{style:{paddingBottom:"0.5em",paddingTop:"0.5em"}},r.a.createElement(E.a,null,r.a.createElement(S.a,{xs:12,sm:12,md:12,lg:12,xl:12},r.a.createElement(Ee.a,{style:{width:"100%"}},r.a.createElement(we.a,{as:Ee.a,style:{width:"100%"}},r.a.createElement(x.a,{variant:"light","data-label-id":"default",onClick:this.handleCreateAnnotation},r.a.createElement(j.a,{icon:C.w,flip:"horizontal"})," Highlight"),r.a.createElement(we.a.Toggle,{split:!0,variant:"light","data-lable-id":0}),r.a.createElement(we.a.Menu,{onClick:this.handleCreateAnnotation},this.state.labelsOptions&&this.state.labelsOptions.map((function(e){return r.a.createElement(we.a.Item,{key:"label_id_".concat(e.id),"data-label-id":e.id},r.a.createElement(E.a,{"data-label-id":e.id},r.a.createElement(S.a,{xs:1,sm:1,md:1,lg:1,xl:1,style:{backgroundColor:e.color},"data-label-id":e.id}),r.a.createElement(S.a,{xs:1,sm:1,md:1,lg:1,xl:1,"data-label-id":e.id},e.label)))})))),r.a.createElement(ye.a,{drop:"right",as:Ee.a,title:r.a.createElement(j.a,{icon:C.g}),id:"bg-nested-dropdown",variant:"light"},r.a.createElement(tt,{isLabelsListOpen:this.state.isLabelsListOpen,labelsOptions:this.state.labelsOptions&&this.state.labelsOptions,onLabelUpdate:this.onLabelUpdate,onLabelCreate:this.onLabelCreate,onLabelDelete:this.onLabelDelete})))))),r.a.createElement(y.a.Body,{style:{paddingBottom:"0px",paddingTop:"0px"}},r.a.createElement(Oe,{labelsOptions:this.state.labelsOptions,speakersOptions:this.props.transcript?rt(this.props.transcript.paragraphs):null,handleSearch:this.handleSearch,handleLabelsSearchChange:this.handleLabelsSearchChange,handleSpeakersSearchChange:this.handleSpeakersSearchChange,handleShowParagraphsMatchingSearch:this.handleShowParagraphsMatchingSearch})),r.a.createElement("hr",{style:{margin:"0px"}}),r.a.createElement(y.a.Body,{onDoubleClick:this.handleWordClick,onClick:this.handleTimecodeClick,style:{height:"62.5vh",overflow:"scroll"}},n,this.props.transcript&&!this.state.componentMounted&&r.a.createElement(x.a,{size:"lg",variant:"light",onClick:this.handleLoadTranscription,block:!0},"Load transcription"),this.props.transcript&&this.state.componentMounted&&r.a.createElement(Re,{labelsOptions:this.state.labelsOptions&&this.state.labelsOptions,annotations:this.state.annotations?this.state.annotations:[],transcriptJson:this.props.transcript,searchString:this.state.searchString?this.state.searchString:"",showParagraphsMatchingSearch:this.state.showParagraphsMatchingSearch,selectedOptionLabelSearch:this.state.selectedOptionLabelSearch?this.state.selectedOptionLabelSearch:[],selectedOptionSpeakerSearch:this.state.selectedOptionSpeakerSearch?this.state.selectedOptionSpeakerSearch:[],transcriptId:this.props.transcriptId,handleTimecodeClick:this.handleTimecodeClick,handleWordClick:this.handleWordClick,handleDeleteAnnotation:this.handleDeleteAnnotation,handleEditAnnotation:this.handleEditAnnotation}))))}}]),t}(n.Component),st={control:function(e){return Object(ke.a)({},e,{backgroundColor:"white"})},option:function(e){return Object(ke.a)({},e,{backgroundColor:null,cursor:"default"})},multiValue:function(e){return Object(ke.a)({},e,{backgroundColor:"white",border:"0.05em solid grey"})},multiValueLabel:function(e){return Object(ke.a)({},e)},multiValueRemove:function(e){return Object(ke.a)({},e)}},it=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleSpeakersSearchChange=function(e){a.props.handleSpeakersSearchChange(e)},a.handleLabelsSearchChange=function(e){a.props.handleLabelsSearchChange(e)},a.handleShowParagraphsMatchingSearch=function(){a.setState((function(e){return a.props.handleShowParagraphsMatchingSearch(!e.showParagraphsMatchingSearch),{showParagraphsMatchingSearch:!e.showParagraphsMatchingSearch}}),(function(){}))},a.handleTranscriptSearchChange=function(e){a.props.handleTranscriptSearchChange(e),a.setState({selectedOptionTranscriptSearch:e})},a.state={isShowingFilterOptions:!1,showParagraphsMatchingSearch:!1,showTextSearchPreferences:!1,showSpeakersSearchPreferences:!1,showLabelsSearchPreferences:!1,selectedOptionTranscriptSearch:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{className:"mb-3"},r.a.createElement(S.a,{xs:1,sm:1,md:1,ld:1,xl:1},r.a.createElement(x.a,{variant:"light",onClick:this.props.handleShowAdvancedSearchViewSearchingAcrossTranscripts,title:"close search across transcript in a project"},r.a.createElement(j.a,{icon:C.a}))),r.a.createElement(S.a,{xs:10,sm:11,md:11,ld:11,xl:11},r.a.createElement(I.a,null,r.a.createElement(L.a,{onChange:function(t){e.props.handleSearch(t,{showParagraphsMatchingSearch:e.state.showParagraphsMatchingSearch,showLabelsSearchPreferences:e.state.showLabelsSearchPreferences,showSpeakersSearchPreferences:e.state.showSpeakersSearchPreferences,selectedOptionTranscriptSearch:e.state.selectedOptionTranscriptSearch})},value:this.props.searchValue,placeholder:"Search text...","aria-label":"search","aria-describedby":"search"}),r.a.createElement(I.a.Append,null,r.a.createElement(I.a.Text,null,r.a.createElement(j.a,{icon:C.H})))))),r.a.createElement(E.a,{className:"mb-3"},r.a.createElement(S.a,{xs:1,sm:1,md:1,ld:1,xl:1},r.a.createElement(I.a.Prepend,null,r.a.createElement(I.a.Text,null,r.a.createElement(j.a,{icon:C.l})))),r.a.createElement(S.a,{xs:10,sm:11,md:11,ld:11,xl:11},r.a.createElement(xe.a,{value:this.state.selectedOptionTranscriptSearch,onChange:this.handleTranscriptSearchChange,isMulti:!0,isSearchable:!0,options:this.props.transcriptOptions,styles:st,placeholder:"Filter by transcripts..."}))),r.a.createElement(E.a,{className:"mb-3"},r.a.createElement(S.a,{xs:1,sm:1,md:1,ld:1,xl:1},r.a.createElement(I.a.Prepend,null,r.a.createElement(I.a.Text,null,r.a.createElement(j.a,{icon:C.T})))),r.a.createElement(S.a,{xs:10,sm:11,md:11,ld:11,xl:11},r.a.createElement(xe.a,{value:this.state.selectedOptionSpeakerSearch,onChange:this.handleSpeakersSearchChange,isMulti:!0,isSearchable:!0,options:this.props.speakersOptions,styles:st,placeholder:"Filter by speakers..."}))),r.a.createElement(E.a,{className:"mb-3"},r.a.createElement(S.a,{xs:1,sm:1,md:1,ld:1,xl:1},r.a.createElement(I.a.Prepend,null,r.a.createElement(I.a.Text,null,r.a.createElement(j.a,{icon:C.N})))),r.a.createElement(S.a,{xs:10,sm:11,md:11,ld:11,xl:11},r.a.createElement(xe.a,{value:this.state.selectedOptionLabelSearch,onChange:this.handleLabelsSearchChange,isMulti:!0,isSearchable:!0,options:this.props.labelsOptions,styles:je,placeholder:"Filter by labels..."}))))}}]),t}(n.Component),ct=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleSearch=function(e,t){if(console.log("Transcripts:: SEARCH:::",e.target.value,t),""!==e.target.value){var n=e.target.value;a.setState({searchString:n.toLowerCase()}),at(a.highlightWords(n),500)}else""===e.target.value&&a.setState({sentenceToSearchCSS:"",searchString:""})},a.highlightWords=function(e){var t=e.toLowerCase().trim().split(" "),n='.paragraph[data-paragraph-text*="'.concat(t.join(" "),'"]'),r=t.map((function(e,a){var r="".concat(n,' > div > span.words[data-text="').concat(e.toLowerCase().trim(),'"]');return a<t.length-1&&(r+=", "),r})),o=t.map((function(e,a){var r="".concat(n,' > div  > span >span.words[data-text="').concat(e.toLowerCase().trim(),'"]');return a<t.length-1&&(r+=", "),r}));a.setState({sentenceToSearchCSS:r.join(" "),sentenceToSearchCSSInHighlights:o.join(" ")})},a.handleLabelsSearchChange=function(e){a.setState({selectedOptionLabelSearch:e})},a.handleSpeakersSearchChange=function(e){a.setState({selectedOptionSpeakerSearch:e})},a.handleTranscriptSearchChange=function(e){a.setState({selectedOptionTranscriptsSearch:e})},a.handleShowParagraphsMatchingSearch=function(e){a.setState({showParagraphsMatchingSearch:e})},a.handleWordClick=function(e){if("words"===e.target.className){var t=e.target;console.log("wordEl",t)}},a.handleFilterResults=function(){console.log("handleFilterResults"),a.setState({searchString:"",sentenceToSearchCSS:"",sentenceToSearchCSSInHighlights:"",selectedOptionLabelSearch:[],selectedOptionSpeakerSearch:[],selectedOptionTranscriptsSearch:[]})},a.handleShowAdvancedSearchViewSearchingAcrossTranscripts=function(){a.setState((function(e){return e.showAdvancedSearchViewSearchingAcrossTranscripts?{showAdvancedSearchViewSearchingAcrossTranscripts:!1,showParagraphsMatchingSearch:!1,selectedOptionLabelSearch:[],selectedOptionSpeakerSearch:[],selectedOptionTranscriptsSearch:[]}:{showAdvancedSearchViewSearchingAcrossTranscripts:!0,showParagraphsMatchingSearch:!0}}))},a.state={searchString:"",sentenceToSearchCSS:"",sentenceToSearchCSSInHighlights:"",selectedOptionLabelSearch:[],selectedOptionSpeakerSearch:[],selectedOptionTranscriptsSearch:[],showParagraphsMatchingSearch:!1,showAdvancedSearchViewSearchingAcrossTranscripts:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.transcripts.map((function(e,t){return r.a.createElement(Se.a.Item,{key:e.id},r.a.createElement(Se.a.Link,{disabled:"done"!==e.status,eventKey:e.id},"in-progress"===e.status?r.a.createElement(j.a,{icon:C.e}):"","done"!==e.status&&"in-progress"!==e.status||"error"===e.status?r.a.createElement(j.a,{icon:C.i}):"","  ".concat(e.transcriptTitle)))})),a=this.props.transcripts.map((function(e){return e.id&&e.transcriptTitle?{id:e.id,value:e.id,label:e.transcriptTitle,description:e.description,status:e.status}:{status:e.status}})).filter((function(e){return"done"===e.status})),n=this.props.transcripts.map((function(e){return e.transcript&&e.transcript.paragraphs?rt(e.transcript.paragraphs):{value:"test",label:"test"}})).reduce((function(e,t){return e.concat(t)}));var o,s=(o=n,Array.from(new Set(o.map(JSON.stringify))).map(JSON.parse)),i=r.a.createElement(it,{labelsOptions:this.props.labelsOptions,speakersOptions:s,handleSearch:this.handleSearch,searchValue:this.state.searchString,handleLabelsSearchChange:this.handleLabelsSearchChange,handleSpeakersSearchChange:this.handleSpeakersSearchChange,handleShowParagraphsMatchingSearch:this.handleShowParagraphsMatchingSearch,transcriptOptions:a,handleTranscriptSearchChange:this.handleTranscriptSearchChange,handleFilterResults:this.handleFilterResults,handleShowAdvancedSearchViewSearchingAcrossTranscripts:this.handleShowAdvancedSearchViewSearchingAcrossTranscripts}),c=this.props.transcripts.map((function(t){return r.a.createElement(ee.a.Pane,{key:t.id,eventKey:t.id},r.a.createElement(ot,{projectId:e.props.projectId,transcriptId:t.id,labelsOptions:e.props.labelsOptions,title:t.transcriptTitle,transcript:t.transcript,url:t.url}))})),l=this.props.transcripts.map((function(t,a){return t.transcript&&e.state.selectedOptionTranscriptsSearch.find((function(e){return t.id===e.id}))?r.a.createElement(Re,{labelsOptions:e.props.labelsOptions,annotations:t.annotations?t.annotations:[],transcriptJson:t.transcript,searchString:e.state.searchString?e.state.searchString:"",showParagraphsMatchingSearch:e.state.showParagraphsMatchingSearch,selectedOptionLabelSearch:e.state.selectedOptionLabelSearch?e.state.selectedOptionLabelSearch:[],selectedOptionSpeakerSearch:e.state.selectedOptionSpeakerSearch?e.state.selectedOptionSpeakerSearch:[],transcriptId:t.id,handleTimecodeClick:e.handleTimecodeClick,handleWordClick:e.handleWordClick,handleDeleteAnnotation:function(){alert("not implemented in this view, switch to individual transcript")},handleEditAnnotation:function(){alert("not implemented in this view, switch to individual transcript")}}):null}));return r.a.createElement(r.a.Fragment,null,r.a.createElement("style",{scoped:!0},"".concat(this.state.sentenceToSearchCSS," { background-color: ","yellow","; text-shadow: 0 0 0.01px black }"),"".concat(this.state.sentenceToSearchCSSInHighlights," { background-color: ","yellow","; text-shadow: 0 0 0.01px black }")),r.a.createElement(ee.a.Container,{defaultActiveKey:this.props.transcripts[0]?this.props.transcripts[0].id:"first"},r.a.createElement(E.a,null,r.a.createElement(S.a,{sm:this.state.showAdvancedSearchViewSearchingAcrossTranscripts?0:3},this.state.showAdvancedSearchViewSearchingAcrossTranscripts?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{onClick:this.handleShowAdvancedSearchViewSearchingAcrossTranscripts,variant:"light",block:!0,title:"Search across transcripts in this project",size:"sm"},r.a.createElement(j.a,{icon:C.H})," Project's Transcripts"),r.a.createElement("hr",null),r.a.createElement(Se.a,{variant:"pills",className:"flex-column"},r.a.createElement("div",{style:{height:"97vh",overflow:"scroll"}},t)))),r.a.createElement(S.a,{sm:this.state.showAdvancedSearchViewSearchingAcrossTranscripts?12:9},r.a.createElement(ee.a.Content,null,this.state.showAdvancedSearchViewSearchingAcrossTranscripts?r.a.createElement(r.a.Fragment,null," ",i,r.a.createElement("section",{style:{height:"80vh",overflow:"auto",border:"solid",borderWidth:"0.01em",borderColor:"lightgrey"}},l)):r.a.createElement(r.a.Fragment,null,c))))))}}]),t}(n.Component),lt=a(82),pt=a.n(lt),dt=function(e){return r.a.createElement("div",{style:{width:"".concat(e.percentage,"%"),background:"red",height:"100%",borderRadius:"inherit"}})},ut=function(e){return r.a.createElement("div",{onClick:e.onClick,style:{position:"relative",height:"12px",width:"100%",opacity:"1"}},r.a.createElement(dt,{percentage:e.percentage}))},ht=function(e,t){return e/t*100},mt=function(e){var t=Object(n.useRef)(),a=Object(n.useState)(0),o=Object(Ve.a)(a,2),s=o[0],i=o[1],c=Object(n.useState)(),l=Object(Ve.a)(c,2),p=l[0],d=l[1],u=Object(n.useState)(0),h=Object(Ve.a)(u,2),m=h[0],f=h[1];return Object(n.useLayoutEffect)((function(){t.current&&f(t.current.offsetWidth)}),[t]),Object(n.useEffect)((function(){d(e.videoContext),p&&function e(){var t=ht(p.currentTime,p.duration);i(t),requestAnimationFrame(e)}()}),[e.videoContext,p]),r.a.createElement("div",{ref:t,style:{width:"100%"}},r.a.createElement(ut,{onClick:function(e){var t=e.nativeEvent.offsetX;p.currentTime=t/m*p.duration;var a=ht(p.currentTime,p.duration);i(a)},percentage:s}))},ft=r.a.createElement(j.a,{icon:C.E}),gt=r.a.createElement(j.a,{icon:C.C}),vt=r.a.createElement(j.a,{icon:C.K}),bt=function(e){var t=Object(n.useState)(!1),a=Object(Ve.a)(t,2),o=a[0],s=a[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(S.a,{sm:6},r.a.createElement(x.a,{size:"sm",block:!0,variant:"light",onClick:o?function(){e.handlePause(),s(!1)}:function(){e.handlePlay(),s(!0)}},o?gt:ft)),r.a.createElement(S.a,{sm:6},r.a.createElement(x.a,{size:"sm",block:!0,variant:"light",onClick:function(){e.handleStop(),s(!1)}},vt)))},Et=a(231),St=a.n(Et),wt=function(e){var t=Object(n.useState)(),a=Object(Ve.a)(t,2),o=a[0],s=a[1];Object(n.useEffect)((function(){e.canvasRef&&e.canvasRef.current&&s(new St.a(e.canvasRef.current))}),[e.canvasRef]),o&&e.playlist.forEach((function(e){var t=e.type,a=e.sourceStart,n=e.start,r=e.duration,s=e.src,i=o[t](s,a);i.startAt(n),i.stopAt(n+r),i.connect(o.destination)}));var i;return r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{className:"justify-content-center",style:{backgroundColor:"black"}},r.a.createElement("canvas",{ref:e.canvasRef,width:e.width,height:.5625*e.width})),r.a.createElement(E.a,{className:"justify-content-center",style:{backgroundColor:"lightgrey"}},r.a.createElement(mt,{videoContext:o})),r.a.createElement(E.a,{style:{marginTop:"0.4em"}},r.a.createElement(bt,{handlePlay:o?function(){return o.play()}:function(){return console.log("handlePlay")},handlePause:o?function(){return o.pause()}:function(){return console.log("handlePause")},handleStop:o?function(){return o.pause(),void s((function(e){return e.currentTime=0,e}))}:function(){return console.log("handleStop")}})),r.a.createElement(E.a,{className:"justify-content-center"},"Total duration: ",o?(i=o.duration,new Date(1e3*i).toISOString().substr(11,8)):"00:00:00"))};wt.defaultProps={playlist:[]};var yt=wt,xt=function(e){var t=Object(n.useRef)();return r.a.createElement(yt,{width:e.width,canvasRef:t,playlist:e.playlist})};xt.defaultProps={playlist:[]};var kt=xt,jt=a(72),Ct=a(232),Ot=a.n(Ct),Tt=a(233),Pt=a.n(Tt),It=a(234),Lt=a.n(It),Nt=a(235),Ft=a.n(Nt),At=a(62),Dt=a.n(At),Mt=a(134),Ut=a.n(Mt),Bt=a(141),_t=a(236),Rt=a.n(_t),Wt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"text-muted"},r.a.createElement(j.a,{icon:C.A})," ",this.props.text))}}]),t}(n.Component),Jt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e;return this.props.words&&(e=this.props.words.map((function(e,t){return r.a.createElement("span",{key:e.start+t,className:"words",title:"stat: ".concat(e.start,"- end: ").concat(e.end),"data-start":e.start,"data-end":e.end},e.text," ")}))),r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,null,r.a.createElement(S.a,{sm:3,className:"text-truncate text-muted",title:"".concat(this.props.speaker.toUpperCase()),style:{userSelect:"none"}},r.a.createElement("strong",null,this.props.speaker.toUpperCase())),r.a.createElement(S.a,{sm:9},e)))}}]),t}(n.Component),Vt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("h4",null,this.props.title)}}]),t}(n.Component),qt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("p",{className:"text-secondary"},r.a.createElement(j.a,{icon:C.J})," ",this.props.text)}}]),t}(n.Component),zt=function(e){var t=e.text;return r.a.createElement("span",{style:{width:"100%",backgroundColor:"orange",color:"#f9f9f9"}}," ",r.a.createElement(j.a,{icon:C.c})," ",t," ")},Ht=Object(Bt.c)((function(){return r.a.createElement("span",{style:{cursor:"move"}}," ",r.a.createElement(j.a,{icon:C.t})," ")})),Kt={border:"none",width:"100%",marginTop:"0.75em",height:"0.1em",backgroundColor:"lightgrey"},Gt=Object(Bt.b)((function(e){var t=e.indexNumber,a=e.value,o=e.type,s=e.handleDelete,i=e.handleEdit,c=e.handleAddTranscriptElementToProgrammeScript,l=e.handleAddTranscriptSelectionToProgrammeScriptTmpSave,p=e.handleChangeInsertPointPosition,d=Object(n.useState)(!1),u=Object(Ve.a)(d,2),h=u[0],m=u[1],f=Object(n.useState)(Object(ke.a)({},Kt,{backgroundColor:"transparent"})),g=Object(Ve.a)(f,2),v=g[0],b=g[1],w=function(e){e.preventDefault(),m(!0)};return r.a.createElement("li",{style:{}},r.a.createElement(E.a,null,r.a.createElement(S.a,{xs:1,sm:1,md:1,ld:1,xl:1,style:{backgroundColor:"insert-point"===o?"orange":""}},r.a.createElement(Ht,null)),r.a.createElement(S.a,{xs:8,sm:9,md:9,ld:9,xl:9,style:{backgroundColor:"insert-point"===o?"orange":""}},a),r.a.createElement(S.a,{xs:1,sm:1,md:1,ld:1,xl:1,style:{backgroundColor:"insert-point"===o?"orange":""}},"paper-cut"!==o&&"insert-point"!==o?r.a.createElement(j.a,{className:"text-muted",style:{cursor:"pointer"},icon:C.D,onClick:function(){i(t)}}):null),r.a.createElement(S.a,{xs:1,sm:1,md:1,ld:1,xl:1,style:{backgroundColor:"insert-point"===o?"orange":""}},"insert-point"!==o?r.a.createElement(j.a,{className:"text-muted",style:{cursor:"pointer"},icon:C.Q,onClick:function(){s(t)}}):null,"insert-point"===o?r.a.createElement(j.a,{style:{color:"white"},icon:C.b}):null)),r.a.createElement(E.a,null,r.a.createElement(S.a,null,r.a.createElement(E.a,null,h?r.a.createElement(Ee.a,{size:"sm",block:!0,style:{cursor:"pointer",width:"100%"}},r.a.createElement(x.a,{variant:"light",onClick:function(){m(!1)}},r.a.createElement(j.a,{icon:C.P})),r.a.createElement(x.a,{variant:"light",onClick:function(){!function(e){l(e)}(t),m(!1)}},r.a.createElement(j.a,{icon:C.B})," Paste Selection"),r.a.createElement(x.a,{variant:"light",onClick:function(){c("title",t),m(!1)}},r.a.createElement(j.a,{icon:C.u})," Heading"),r.a.createElement(x.a,{variant:"light",onClick:function(){c("voice-over",t),m(!1)}},r.a.createElement(j.a,{icon:C.A}),"  Voice over"),r.a.createElement(x.a,{variant:"light",onClick:function(){c("note",t),m(!1)}},r.a.createElement(j.a,{icon:C.J})," Note"),r.a.createElement(x.a,{variant:"light",onClick:function(){p(t),m(!1)},title:"move insert point"},"Move insert Point",r.a.createElement(j.a,{icon:C.c}),r.a.createElement(j.a,{icon:C.b}))):null))),r.a.createElement(E.a,null,r.a.createElement(S.a,{xs:1,sm:1,md:1,ld:1,xl:1,style:{cursor:"context-menu"},onMouseOver:function(){b(Object(ke.a)({},Kt,{backgroundColor:"lightgrey"}))},onMouseLeave:function(){b(Object(ke.a)({},Kt,{backgroundColor:"transparent"}))},onClick:w},"lightgrey"===v.backgroundColor?r.a.createElement("span",{style:{color:"grey"}},"+"):null),r.a.createElement(S.a,{xs:11,sm:11,md:11,ld:11,xl:11,style:{cursor:"context-menu"},onMouseOver:function(){b(Object(ke.a)({},Kt,{backgroundColor:"lightgrey"}))},onMouseLeave:function(){b(Object(ke.a)({},Kt,{backgroundColor:"transparent"}))},onClick:w},r.a.createElement("div",{className:"insertDiv",style:v}))))})),Xt=Object(Bt.a)((function(e){var t=e.children;return r.a.createElement("ul",{style:{listStyle:"none",padding:"0px"}},t)})),Yt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).onSortEnd=function(e){var t=e.oldIndex,n=e.newIndex,r=Rt()(a.props.programmeScriptElements,t,n);a.props.handleProgrammeScriptOrderChange(r)},a.state={},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t,a=this;return this.props.programmeScriptElements&&(e=this.props.programmeScriptElements.map((function(e,t){switch(e.type){case"title":return{el:r.a.createElement(Vt,{key:e.id,title:e.text}),type:e.type};case"voice-over":return{el:r.a.createElement(Wt,{key:e.id,text:e.text}),type:e.type};case"paper-cut":return{el:r.a.createElement(Jt,{key:e.id,el:e,speaker:e.speaker,words:e.words}),type:e.type};case"note":return{el:r.a.createElement(qt,{key:e.id,text:e.text}),type:e.type};case"insert-point":return{el:r.a.createElement(zt,{text:e.text}),type:e.type};default:return console.error("invalid programme element type"),null}}))),this.props.programmeScriptElements&&(t=r.a.createElement(Xt,{useDragHandle:!0,onSortEnd:this.onSortEnd},e.map((function(e,t){return r.a.createElement(Gt,{key:"item-".concat(t),index:t,indexNumber:t,value:e.el,type:e.type,handleDelete:a.props.handleDeleteProgrammeScriptElement,handleEdit:a.props.handleEditProgrammeScriptElement,handleAddTranscriptElementToProgrammeScript:a.props.handleAddTranscriptElementToProgrammeScript,handleAddTranscriptSelectionToProgrammeScriptTmpSave:a.props.handleAddTranscriptSelectionToProgrammeScriptTmpSave,handleChangeInsertPointPosition:a.props.handleChangeInsertPointPosition})})))),r.a.createElement(r.a.Fragment,null,t)}}]),t}(n.Component);var Qt=function(e){var t=e.onClick,a=e.title,n=e.text,o=e.tootlipDelay;return r.a.createElement(Me.a,{placement:"left",delay:o,overlay:r.a.createElement(jt.a,null,a)},r.a.createElement(we.a.Item,{variant:"light",eventKey:"1",onClick:t},n))};function $t(e){return{start:parseFloat(e.dataset.start),end:parseFloat(e.dataset.end),text:e.innerText,speaker:e.dataset.speaker,transcriptId:e.dataset.transcriptId}}var Zt=function(e){if(!window.getSelection().isCollapsed){var t=window.getSelection().getRangeAt(0).cloneContents().querySelectorAll(".words");if(0!==t.length)return{start:parseFloat(t[0].dataset.start),end:parseFloat(t[t.length-1].dataset.end),transcriptId:t[0].dataset.transcriptId,speaker:t[0].dataset.speaker,words:Array.from(t).map((function(e){return $t(e)}))};var a=window.getSelection().anchorNode.parentElement;return"words"===a.className&&{start:parseFloat(a.dataset.start),end:parseFloat(a.dataset.end),transcriptId:a.dataset.transcriptId,speaker:a.dataset.speaker,words:[$t(a)]}}return!1},ea=function(e){var t=e[0];return 0===e.filter((function(e){return e.speaker!==t.speaker})).length},ta=function(e){if(ea(e))return e;var t=e[0].speaker,a=[],n=[];return e.forEach((function(r,o){r.speaker===t?a.push(r):(n.push(a),(a=[]).push(r),t=r.speaker),o===e.length-1&&n.push(a)})),n},aa=a(35),na=function(e,t){console.log("edlJson",e.title);var a=e.title,n=new aa.Document({creator:"Test",description:"Test Description",title:a}),r=[];return e.events.forEach((function(e){if("title"===e.type)r.push(new aa.Paragraph({text:e.text,heading:aa.HeadingLevel.HEADING_1,spacing:{after:200}}));else if("voice-over"===e.type)r.push(new aa.Paragraph({children:[new aa.TextRun({text:"Voice Over:\t",italics:!1,bold:!0}),new aa.TextRun({text:"".concat(e.text)})],spacing:{after:200}}));else if("note"===e.type)r.push(new aa.Paragraph({children:[new aa.TextRun({text:"Notes:\t",italics:!0,bold:!0}),new aa.TextRun({text:"".concat(e.text),italics:!0})],spacing:{after:200}}));else if("paper-cut"===e.type){var a=e.words.map((function(e){return e.text})).join(" ");r.push(new aa.Paragraph({children:[new aa.TextRun({text:"".concat(e.speaker,"\t"),bold:!0,allCaps:!0}),new aa.TextRun({text:"".concat(a)})],spacing:{after:100}})),t&&r.push(new aa.Paragraph({children:[new aa.TextRun({text:"".concat(e.clipName,"\t [").concat(Object(ve.b)(e.start)," - ").concat(Object(ve.b)(e.end),"]"),size:18})],spacing:{after:200}}))}return null})),n.addSection({properties:{},children:[new aa.Paragraph({text:a,heading:aa.HeadingLevel.TITLE,alignment:aa.AlignmentType.CENTER})].concat(r)}),new Promise((function(e,t){return aa.Packer.toBlob(n).then((function(t){console.log(t),e(t),console.log("Document created successfully")})).catch((function(e){t(e)}))}))},ra=(a(484),a(237));var oa=function(e){var t=Object(n.useState)(!1),o=Object(Ve.a)(t,2),s=o[0],i=o[1],c=Object(n.useState)("cline"),l=Object(Ve.a)(c,2),p=l[0],d=l[1],u=Object(n.useState)("blue"),h=Object(Ve.a)(u,2),m=h[0],f=h[1],g=function(){return i(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(we.a.Item,{variant:"light",eventKey:"1",onClick:function(){return i(!0)}},e.text),r.a.createElement(A.a,{show:s,onHide:g},r.a.createElement(A.a.Header,{closeButton:!0},r.a.createElement(A.a.Title,null,"Export audio as video waveform")),r.a.createElement(A.a.Body,null,r.a.createElement(D.a.Group,{controlId:"exampleForm.ControlSelect1"},r.a.createElement(D.a.Label,null,"Select waveform style"),r.a.createElement(D.a.Control,{as:"select",onChange:function(e){var t=e.target.value;console.log("handleSetWaveFormMode",t),d(t)}},r.a.createElement("option",{value:"cline"},"cline"),r.a.createElement("option",{value:"point"},"point"),r.a.createElement("option",{value:"p2p"},"p2p"),r.a.createElement("option",{value:"line"},"line"))),r.a.createElement(ra.a,{src:a(485)("./".concat(p,".gif")),alt:"loading...",fluid:!0}),r.a.createElement($e,{color:m,handleColorSelectChange:function(e){console.log("handleColorSelectChange",e),f(e)}})),r.a.createElement(A.a.Footer,null,r.a.createElement(x.a,{variant:"secondary",onClick:g},"Close"),r.a.createElement(x.a,{variant:"primary",onClick:function(){e.handleExportAudioPreviewWithVideoWaveform({waveFormMode:p,waveFormColor:m}),i(!1)}},"Submit"))))},sa={type:"insert-point",text:"Insert Point to add selection"},ia=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).mouseUpListener=function(){if(window.getSelection||document.selection){var e=Zt();e&&(a.setState({tmpSelection:e}),a.state.isAdvancedSelect&&a.handleAddTranscriptSelectionToProgrammeScript())}},a.componentDidMount=function(){Q.getPaperEdit(a.props.projectId,a.props.papereditId).then((function(e){var t=e.programmeScript;t.elements.push(sa),a.setState({programmeScript:t})})),document.addEventListener("mouseup",a.mouseUpListener)},a.componentWillUnmount=function(){try{document.removeEventListener("mouseup",a.mouseUpListener)}catch(e){console.error("error removing listener mouseup",e)}},a.handleProgrammeScriptOrderChange=function(e){a.setState((function(t){var a=t.programmeScript;return a.elements=e,{programmeScript:a}}),(function(){a.handleSaveProgrammeScript(),a.handleUpdatePreview()}))},a.handleDeleteProgrammeScriptElement=function(e){a.setState((function(t){var a=t.programmeScript,n=e,r=a.elements;return r.splice(n,1),a.elements=r,{programmeScript:a}}),(function(){a.handleSaveProgrammeScript(),a.handleUpdatePreview()}))},a.handleEditProgrammeScriptElement=function(e){var t=a.state.programmeScript,n=t.elements,r=n[e],o=prompt("Edit",r.text);o&&(r.text=o,n[e]=r,t.elements=n,a.setState({programmeScript:t},(function(){a.handleSaveProgrammeScript()})))},a.handleAddTranscriptElementToProgrammeScript=function(e,t){console.log("handleAddTranscriptElementToProgrammeScript",e,t);var n=a.state.programmeScript,r=a.state.programmeScript.elements;if("title"===e||"note"===e||"voice-over"===e){var o=prompt("Add some text for a section title","Some place holder text");if(o){var s=0;s=t||0===t?t+1:a.getIndexPositionOfInsertPoint();var i={id:pt()(),index:r.length,type:e,text:o};r.splice(s,0,i),n.elements=r,a.setState({programmeScript:n},(function(){a.handleSaveProgrammeScript()}))}}},a.getIndexPositionOfInsertPoint=function(){var e=a.state.programmeScript.elements,t=e.find((function(e){return"insert-point"===e.type}));return e.indexOf(t)},a.handleAddTranscriptSelectionToProgrammeScriptTmpSave=function(e){var t=a.state.tmpSelection;if(t&&t.transcriptId&&t.speaker){var n=a.state.programmeScript,r=n.elements,o=0;if(o=e||0===e?e+1:a.getIndexPositionOfInsertPoint(),ea(t.words)){var s={id:pt()(),index:r.length,type:"paper-cut",start:t.start,end:t.end,speaker:t.speaker,words:t.words,transcriptId:t.transcriptId,labelId:[]};r.splice(o,0,s),n.elements=r}else{ta(t.words).reverse().forEach((function(e){var t={id:pt()(),index:r.length,type:"paper-cut",start:e[0].start,end:e[e.length-1].end,speaker:e[0].speaker,words:e,transcriptId:e[0].transcriptId,labelId:[]};r.splice(o,0,t),n.elements=r}))}a.setState({programmeScript:n},(function(){a.handleSaveProgrammeScript(),a.handleUpdatePreview()}))}else alert("Select some text in the transcript to add to the programme script")},a.handleAddTranscriptSelectionToProgrammeScript=function(e,t){var n=Zt();if(n){var r=a.state.programmeScript,o=r.elements,s=0;if(s=t||0===t?t+1:a.getIndexPositionOfInsertPoint(),ea(n.words)){var i={id:pt()(),index:o.length,type:"paper-cut",start:n.start,end:n.end,speaker:n.speaker,words:n.words,transcriptId:n.transcriptId,labelId:[]};o.splice(s,0,i),r.elements=o}else{ta(n.words).reverse().forEach((function(e){var t={id:pt()(),index:o.length,type:"paper-cut",start:e[0].start,end:e[e.length-1].end,speaker:e[0].speaker,words:e,transcriptId:e[0].transcriptId,labelId:[]};o.splice(s,0,t),r.elements=o}))}a.setState({programmeScript:r},(function(){a.handleSaveProgrammeScript(),a.handleUpdatePreview(),window.getSelection().collapse(document,0)}))}else alert("Select some text in the transcript to add to the programme script")},a.getSequenceJsonEDL=function(){var e,t={title:a.state.programmeScript.title,events:[]},n=a.state.programmeScript.elements.map((function(e){if("paper-cut"===e.type){var t=a.props.transcripts.find((function(t){return t.id===e.transcriptId})),n=25;return t.metadata&&t.metadata.fps&&"NA"!==t.metadata.fps&&(n=t.metadata.fps),{startTime:e.start,endTime:e.end,reelName:t.metadata?t.metadata.reelName:"NA",clipName:"".concat(t.clipName),fps:n,offset:t.metadata?t.metadata.timecode:"00:00:00:00",sampleRate:t.metadata?t.metadata.sampleRate:"16000"}}return null})).filter((function(e){return null!==e})).map((function(e,t){return e.id=t+1,e}));return(e=t.events).push.apply(e,Object(g.a)(n)),t},a.getSequenceJsonForFfmpegRemix=function(){return a.state.programmeScript.elements.map((function(e){if("paper-cut"===e.type){console.log(e);var t=a.props.transcripts.find((function(t){return t.id===e.transcriptId}));return{start:parseFloat(e.start),end:parseFloat(e.end),source:"".concat(t.url)}}return null})).filter((function(e){return null!==e}))},a.handleExportEDL=function(){var e=a.getSequenceJsonEDL(),t=new Ot.a(e);Dt()(t.compose(),"".concat(a.state.programmeScript.title,".edl"),"text/plain")},a.handleExportADL=function(){var e=a.getSequenceJsonEDL(),t=e.events[0],n=25;t.fps&&"NA"!==t.fps&&(n=t.fps);var r=Pt()({projectOriginator:"Digital Paper Edit",edits:e.events.map((function(e){return{start:e.startTime,end:e.endTime,clipName:e.clipName,label:""}})),sampleRate:t.sampleRate,frameRate:n,projectName:e.title});Dt()(r,"".concat(a.state.programmeScript.title,".adl"),"text/plain")},a.handleExportFCPX=function(){var e=a.getSequenceJsonEDL(),t=Lt()(e);Dt()(t,"".concat(a.state.programmeScript.title,".fcpxml"),"text/plain")},a.handleExportXML=function(){var e=a.getSequenceJsonEDL(),t=Ft()(e);Dt()(t,"".concat(a.state.programmeScript.title,".xml"),"text/plain")},a.getProgrammeScriptJson=function(){var e,t={title:a.state.programmeScript.title,events:[]},n=a.state.programmeScript.elements.map((function(e){if("paper-cut"===e.type){var t=a.props.transcripts.find((function(t){return t.id===e.transcriptId})),n=25;return t.metadata&&t.metadata.fps&&"NA"!==t.metadata.fps&&(n=t.metadata.fps),Object(ke.a)({},e,{src:t.url,startTime:e.start,endTime:e.end,reelName:t.metadata?t.metadata.reelName:"NA",clipName:"".concat(t.clipName),fps:n,sampleRate:t.metadata?t.metadata.sampleRate:"16000",offset:t.metadata?t.metadata.timecode:"00:00:00:00"})}return e})).filter((function(e){return null!==e})).map((function(e,t){return e.id=t+1,e}));return(e=t.events).push.apply(e,Object(g.a)(n)),t},a.programmeScriptJsonToText=function(e){var t="# ".concat(e.title,"\n\n"),a=e.events.map((function(e){return"title"===e.type?"## ".concat(e.text):"voice-over"===e.type?"_".concat(e.text,"_"):"note"===e.type?"[ ".concat(e.text,"]"):"paper-cut"===e.type?"".concat(Ut.a.fromSeconds(e.startTime),"\t").concat(Ut.a.fromSeconds(e.endTime),"\t").concat(e.speaker,"\t-\t").concat(e.clipName,"     \n").concat(e.words.map((function(e){return e.text.replace(/'/,"'")})).join(" ")):null}));return"".concat(t).concat(a.join("\n\n"))},a.programmeScriptJsonToTextPaperCutsOnly=function(e){var t=e.events.map((function(e){return"paper-cut"===e.type?"".concat(e.words.map((function(e){return e.text.replace(/'/,"'")})).join(" ")):null}));return"".concat(t.filter((function(e){return null!==e})).join("\n\n"))},a.handleExportJson=function(){var e=a.getProgrammeScriptJson(),t=JSON.stringify(e,null,2);Dt()(t,"".concat(a.state.programmeScript.title,".json"),"text/plain")},a.handleCepExportSequence=function(){var e={edlJson:{events:a.getProgrammeScriptJson().events.filter((function(e){return"paper-cut"===e.type})).map((function(e){return delete e.words,e})),title:a.state.programmeScript.title}},t="$._PPP.create_sequence_from_paper_edit('"+JSON.stringify(e)+"')";window.__adobe_cep__.evalScript(t,(function(e){console.info("done exporting sequence")}))},a.handleExportTxt=function(){var e=a.getProgrammeScriptJson(),t=a.programmeScriptJsonToText(e);Dt()(t,"".concat(a.state.programmeScript.title,".txt"),"text/plain")},a.handleExportTxtOnyPaperCuts=function(){var e=a.getProgrammeScriptJson(),t=a.programmeScriptJsonToTextPaperCutsOnly(e);Dt()(t,"".concat(a.state.programmeScript.title,".txt"),"text/plain")},a.handleExportDocx=function(){var e,t;return f.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e=a.getProgrammeScriptJson(),!1,n.next=4,f.a.awrap(na(e,!1));case 4:t=n.sent,Dt()(t,"".concat(a.state.programmeScript.title,".docx"),"text/docx");case 6:case"end":return n.stop()}}))},a.handleExportDocxWithClipReference=function(){var e,t;return f.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e=a.getProgrammeScriptJson(),!0,n.next=4,f.a.awrap(na(e,!0));case 4:t=n.sent,Dt()(t,"".concat(a.state.programmeScript.title,".docx"),"text/docx");case 6:case"end":return n.stop()}}))},a.handleUpdatePreview=function(){var e=0,t=a.state.programmeScript.elements.map((function(t){if("paper-cut"===t.type){var n=a.props.transcripts.find((function(e){return e.id===t.transcriptId})),r=t.end-t.start,o={type:"video",start:e,sourceStart:t.start,duration:r,src:n.url};return e+=r,o}return null})).filter((function(e){return null!==e}));a.setState({resetPreview:!0},(function(){a.setState({resetPreview:!1,playlist:t})})),a.setState({playlist:t})},a.handleDoubleClickOnProgrammeScript=function(e){if("words"===e.target.className)e.target.dataset.start},a.handleSaveProgrammeScript=function(){var e=a.state.programmeScript,t=Object(ke.a)({},e);if(t){var n=Object(g.a)(t.elements),r=n.find((function(e){return"insert-point"===e.type}));if(r){var o=n.indexOf(r);n.splice(o,1)}t.elements=n,Q.updatePaperEdit(a.props.projectId,a.props.papereditId,t).then((function(e){"ok"===e.status&&a.setState({lastSaved:new Date})}))}},a.handleChangeInsertPointPosition=function(e){var t=a.state.programmeScript,n=Object(ke.a)({},t);if(n){var r=Object(g.a)(n.elements),o=r.find((function(e){return"insert-point"===e.type})),s=Object(ke.a)({},sa);if(r.splice(e+1,0,s),o){var i=r.indexOf(o);r.splice(i,1)}n.elements=r,Q.updatePaperEdit(a.props.projectId,a.props.papereditId,n).then((function(e){"ok"===e.status&&a.setState({lastSaved:new Date,programmeScript:n},(function(){}))}))}},a.handleAdvancedSelectCheckbox=function(e){var t=e.target;a.setState({isAdvancedSelect:t.checked})},a.handleDeleteProgrammeScriptContent=function(){if(confirm("Are you usure you want to delete the content of your programme script?")){var e=a.state.programmeScript,t=Object(ke.a)({},e);t.elements=[Object(ke.a)({},sa)],Q.updatePaperEdit(a.props.projectId,a.props.papereditId,t).then((function(e){"ok"===e.status&&a.setState({lastSaved:new Date,programmeScript:t},(function(){a.handleUpdatePreview()}))}))}else alert("ok no worries, nothing changed")},a.handleExportVideoPreview=function(){var e=a.getSequenceJsonForFfmpegRemix(),t=a.state.programmeScript.title,n=(new Date).toLocaleString().replace(/\//g,"-").replace(/,\ /g,"_").replace(/:/g,".").replace(/\ /g,""),r="".concat(t,"_").concat(n,".mp4");Q.exportVideo(e,r).then((function(e){console.log("exported",e)}))},a.handleExportAudioPreview=function(){var e=a.getSequenceJsonForFfmpegRemix(),t=a.state.programmeScript.title,n=(new Date).toLocaleString().replace(/\//g,"-").replace(/,\ /g,"_").replace(/:/g,".").replace(/\ /g,""),r="".concat(t,"_").concat(n,".wav");Q.exportAudio(e,r,!1).then((function(e){console.log("exported",e)}))},a.handleExportAudioPreviewWithVideoWaveform=function(e){var t=e.waveFormMode,n=e.waveFormColor,r=a.getSequenceJsonForFfmpegRemix(),o=a.state.programmeScript.title,s=(new Date).toLocaleString().replace(/\//g,"-").replace(/,\ /g,"_").replace(/:/g,".").replace(/\ /g,""),i="".concat(o,"_").concat(s,".mp4");Q.exportAudio(r,i,!0,t,n).then((function(e){console.log("exported",e)}))},a.state={lastSaved:new Date,programmeScript:null,resetPreview:!1,isAdvancedSelect:!1,playlist:[]},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=!!window.matchMedia("(max-width: 767px)").matches;return r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{style:{}},r.a.createElement(y.a.Body,{style:{padding:"1em",paddingTop:"0em",paddingBottom:"0.6em"}},this.state.resetPreview?null:r.a.createElement(kt,{playlist:this.state.playlist,width:300})),r.a.createElement(y.a.Body,{style:{paddingTop:"0px",paddingBottom:"0.6em"}},r.a.createElement(E.a,{noGutters:!0},r.a.createElement(Ee.a,{style:{width:"100%"},vertical:t,block:!0},r.a.createElement(Me.a,{placement:"top",delay:3e3,overlay:r.a.createElement(jt.a,null,"To add a text selection, select text in the transcript, then click this button to add it to the programme script, at the orange insert point/")},r.a.createElement(x.a,{variant:"light",size:"sm",onClick:this.handleAddTranscriptSelectionToProgrammeScript},r.a.createElement(j.a,{icon:C.F})," Selection")),r.a.createElement(Me.a,{placement:"top",delay:3e3,overlay:r.a.createElement(jt.a,null,"Advanced selection - check this box to auto copy across transcript selections to insert point in programme script")},r.a.createElement(x.a,{variant:"light",style:{cursor:"default"}},r.a.createElement("input",{style:{cursor:"pointer"},name:"advancedSelect",type:"checkbox",checked:this.state.isAdvancedSelect,onChange:this.handleAdvancedSelectCheckbox})," ",r.a.createElement("small",{className:"text-secondary",style:{marginBottom:"0em"}},"Auto copy selections"))),r.a.createElement(ye.a,{as:Ee.a,variant:"light",title:r.a.createElement(j.a,{icon:C.y})},r.a.createElement(Qt,{tootlipDelay:3e3,onClick:function(){e.handleAddTranscriptElementToProgrammeScript("title")},title:"Add a title header element to the programme script",text:r.a.createElement(r.a.Fragment,null," ",r.a.createElement(j.a,{icon:C.u})," Heading")}),r.a.createElement(Qt,{tootlipDelay:3e3,onClick:function(){e.handleAddTranscriptElementToProgrammeScript("voice-over")},title:"Add a title voice over element to the programme script",text:r.a.createElement(r.a.Fragment,null," ",r.a.createElement(j.a,{icon:C.A})," Voice Over")}),r.a.createElement(Qt,{tootlipDelay:3e3,onClick:function(){e.handleAddTranscriptElementToProgrammeScript("note")},title:"Add a note element to the programme script",text:r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{icon:C.J})," Note")})),r.a.createElement(Me.a,{placement:"top",delay:3e3,overlay:r.a.createElement(jt.a,null,"update programme script audio/video preview")},r.a.createElement(x.a,{variant:"light",onClick:this.handleUpdatePreview},r.a.createElement(j.a,{icon:C.L}))),r.a.createElement(ye.a,{as:Ee.a,variant:"light",title:r.a.createElement(j.a,{icon:C.I})},"cep"===X()?r.a.createElement(r.a.Fragment,null,r.a.createElement(Qt,{tootlipDelay:3e3,onClick:this.handleCepExportSequence,title:"export the programme script as a sequence in Adobe Premiere",text:r.a.createElement(r.a.Fragment,null,"Premiere - Sequence ",r.a.createElement(j.a,{icon:C.x}))})):r.a.createElement(r.a.Fragment,null,r.a.createElement(Qt,{tootlipDelay:3e3,onClick:this.handleExportEDL,title:"export EDL, edit decision list, to import the programme script as a sequence in video editing software - Avid, Premiere, Davinci Resolve, for FCPX choose FCPX XML",text:r.a.createElement(r.a.Fragment,null," ",r.a.createElement(j.a,{icon:C.U})," EDL - Video ",r.a.createElement(j.a,{icon:C.x}))}),r.a.createElement(Qt,{tootlipDelay:3e3,title:"export FCPX XML, to import the programme script as a sequence in Final Cut Pro X, video editing software",onClick:this.handleExportFCPX,text:r.a.createElement(r.a.Fragment,null," ",r.a.createElement(j.a,{icon:C.U})," FCPX ",r.a.createElement(j.a,{icon:C.x}))}),r.a.createElement(we.a.Divider,null),r.a.createElement(Qt,{tootlipDelay:3e3,onClick:this.handleExportADL,title:"export ADL, audio decision list, to import the programme script as a sequence in audio editing software such as SADiE",text:r.a.createElement(r.a.Fragment,null," ",r.a.createElement(j.a,{icon:C.v})," ADL - Audio  ",r.a.createElement(j.a,{icon:C.x}))}),r.a.createElement(Qt,{tootlipDelay:3e3,onClick:this.handleExportXML,title:"export XML, audio decision list, to import the programme script as a sequence in audio editing software such as Audition",text:r.a.createElement(r.a.Fragment,null,"   ",r.a.createElement(j.a,{icon:C.v})," XML - Audition ",r.a.createElement(j.a,{icon:C.x}))}),r.a.createElement(we.a.Divider,null),r.a.createElement(Qt,{tootlipDelay:3e3,onClick:this.handleExportTxt,title:"export Text, export the programme script as a text version",text:r.a.createElement(r.a.Fragment,null," ",r.a.createElement(j.a,{icon:C.l})," Text File ",r.a.createElement(j.a,{icon:C.x}))}),r.a.createElement(Qt,{tootlipDelay:3e3,onClick:this.handleExportTxtOnyPaperCuts,title:"export Text, export only the text selection in the programme script as a text version",text:r.a.createElement(r.a.Fragment,null," ",r.a.createElement(j.a,{icon:C.l})," Text File (only text selection) ",r.a.createElement(j.a,{icon:C.x}))}),r.a.createElement(Qt,{tootlipDelay:3e3,onClick:this.handleExportDocx,title:"export docx, export the programme script as a word document",text:r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{icon:C.p})," Word Document ",r.a.createElement(j.a,{icon:C.x}))}),r.a.createElement(Qt,{tootlipDelay:3e3,onClick:this.handleExportDocxWithClipReference,title:"export docx, export the programme script as a word document, with clip name and timecode references, for text selections",text:r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{icon:C.p})," Word Doc (with ref) ",r.a.createElement(j.a,{icon:C.x}))}),"electron"===X()?r.a.createElement(r.a.Fragment,null,r.a.createElement(we.a.Divider,null),r.a.createElement(Qt,{tootlipDelay:3e3,onClick:this.handleExportVideoPreview,title:"Export mp4 video preview - Experimental feature, at the moment you cannot combine audio and video in the same export.",text:r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{icon:C.o})," Video (mp4) ",r.a.createElement(j.a,{icon:C.r})," ",r.a.createElement(j.a,{icon:C.x}))}),r.a.createElement(Qt,{tootlipDelay:3e3,onClick:this.handleExportAudioPreview,title:"Export wav audio preview - Experimental feature, at the moment you cannot combine audio and video in the same export.",text:r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{icon:C.m})," Audio (wav) ",r.a.createElement(j.a,{icon:C.r}),r.a.createElement(j.a,{icon:C.x}))}),r.a.createElement(we.a.Divider,null),r.a.createElement(oa,{TOOLTIP_DEPLAY_IN_MILLISECONDS:3e3,handleExportAudioPreviewWithVideoWaveform:this.handleExportAudioPreviewWithVideoWaveform,title:"Export audio preview as video with animated wave form - Experimental feature, at the moment you cannot combine audio and video in the same export.",text:r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{icon:C.m})," Animated Waveform (mp4)   ",r.a.createElement(j.a,{icon:C.r}),r.a.createElement(j.a,{icon:C.x}))})):null,r.a.createElement(we.a.Divider,null),r.a.createElement(Qt,{tootlipDelay:3e3,onClick:this.handleExportJson,title:"export Json, export the programme script as a json file",text:r.a.createElement(r.a.Fragment,null,"  ",r.a.createElement(j.a,{icon:C.n})," Json ",r.a.createElement(j.a,{icon:C.x}))}))),r.a.createElement(Me.a,{placement:"top",overlay:r.a.createElement(jt.a,null," Last Saved at ".concat(this.state.lastSaved.toLocaleString()))},r.a.createElement(x.a,{variant:"light",disabled:!0},r.a.createElement("small",{className:"text-secondary",style:{marginBottom:"0em"}},"".concat(this.state.lastSaved.toLocaleTimeString())))),r.a.createElement(Me.a,{placement:"top",delay:3e3,overlay:r.a.createElement(jt.a,null,"Delete programme script content.")},r.a.createElement(x.a,{variant:"light",onClick:this.handleDeleteProgrammeScriptContent},r.a.createElement(j.a,{icon:C.Q})))))),r.a.createElement("hr",{style:{margin:"0px"}}),r.a.createElement(y.a.Body,{style:{padding:"0px"}},r.a.createElement("article",{style:{height:"55vh",overflow:"scroll",padding:"1em"},onDoubleClick:this.handleDoubleClickOnProgrammeScript},this.state.programmeScript?r.a.createElement(Yt,{programmeScriptElements:this.state.programmeScript.elements,handleProgrammeScriptOrderChange:this.handleProgrammeScriptOrderChange,handleDeleteProgrammeScriptElement:this.handleDeleteProgrammeScriptElement,handleEditProgrammeScriptElement:this.handleEditProgrammeScriptElement,handleAddTranscriptElementToProgrammeScript:this.handleAddTranscriptElementToProgrammeScript,handleAddTranscriptSelectionToProgrammeScriptTmpSave:this.handleAddTranscriptSelectionToProgrammeScriptTmpSave,handleChangeInsertPointPosition:this.handleChangeInsertPointPosition}):null))))}}]),t}(n.Component),ca=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).componentDidMount=function(){return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:Q.getProgrammeScriptAndTranscripts(a.state.projectId,a.state.papereditId).then((function(e){a.setState({programmeTitle:e.programmeScript.title,projectTitle:e.project.title,transcripts:e.transcripts,labelsOptions:e.labels})}));case 1:case"end":return e.stop()}}))},a.toggleTranscripts=function(){a.state.isProgramScriptShown&&a.setState((function(e){return{isTranscriptsShown:!e.isTranscriptsShown}}))},a.toggleProgramScript=function(){a.state.isTranscriptsShown&&a.setState((function(e){return{isProgramScriptShown:!e.isProgramScriptShown}}))},a.state={projectId:a.props.match.params.projectId,papereditId:a.props.match.params.papereditId,projectTitle:"",programmeTitle:"",transcripts:[],labelsOptions:[],isTranscriptsShown:!0,isProgramScriptShown:!0},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(b.a,{style:{},fluid:!0},r.a.createElement(E.a,null,r.a.createElement(S.a,{xs:12,sm:8,md:8,ld:8,xl:8},r.a.createElement(_,{backgroundColor:"transparent",items:[{name:"Projects",link:"/projects"},{name:"Project: ".concat(this.state.projectTitle),link:"/projects/".concat(this.state.projectId)},{name:"PaperEdits"},{name:"".concat(this.state.programmeTitle)}]})),r.a.createElement(S.a,{xs:12,sm:4,md:4,ld:4,xl:4},r.a.createElement("div",{className:"d-flex flex-column"},r.a.createElement(Ee.a,{className:"mt-2",size:"md",block:!0},r.a.createElement(x.a,{onClick:this.toggleTranscripts,variant:"light",size:"sm"},"Transcripts ",r.a.createElement(j.a,{icon:this.state.isTranscriptsShown?C.j:C.k})),r.a.createElement(x.a,{onClick:this.toggleProgramScript,variant:"light",size:"sm"},"Program Script  ",r.a.createElement(j.a,{icon:this.state.isProgramScriptShown?C.j:C.k})))))),r.a.createElement(b.a,{fluid:!0},r.a.createElement(E.a,null,r.a.createElement(S.a,{xs:{span:12,offset:0},sm:{span:this.state.isProgramScriptShown?7:12,offset:(this.state.isProgramScriptShown,0)},md:{span:this.state.isProgramScriptShown?7:12,offset:(this.state.isProgramScriptShown,0)},lg:{span:this.state.isProgramScriptShown?7:10,offset:this.state.isProgramScriptShown?0:1},xl:{span:this.state.isProgramScriptShown?7:10,offset:this.state.isProgramScriptShown?0:1},style:{display:this.state.isTranscriptsShown?"block":"none"}},r.a.createElement("div",{className:["d-block","d-sm-none"].join(" ")},r.a.createElement("br",null)),this.state.transcripts.length?r.a.createElement(ct,{projectId:this.state.projectId,transcripts:this.state.transcripts,labelsOptions:this.state.labelsOptions}):r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("i",null,"No Transcripts, create a transcript to get started"))),r.a.createElement(S.a,{xs:{span:12,offset:0},sm:{span:this.state.isTranscriptsShown?5:12,offset:(this.state.isTranscriptsShown,0)},md:{span:this.state.isTranscriptsShown?5:12,offset:(this.state.isTranscriptsShown,0)},lg:{span:this.state.isTranscriptsShown?5:10,offset:this.state.isTranscriptsShown?0:1},xl:{span:this.state.isTranscriptsShown?5:8,offset:this.state.isTranscriptsShown?0:2},style:{display:this.state.isProgramScriptShown?"block":"none"}},r.a.createElement(ia,{projectId:this.state.projectId,papereditId:this.state.papereditId,transcripts:this.state.transcripts})))))}}]),t}(n.Component),la=r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null," This is a demo version of the app ",r.a.createElement(ae.a.Link,{href:"https://github.com/pietrop/digital-paper-edit-client",target:"_blank",rel:"noopener noreferrer"},"see project Github repository for more info"),". "),r.a.createElement("p",null,"This is a read-only demo you can only play around with existing projects!")),pa=function(){return r.a.createElement("h1",null,"There was an error loading the page you requested")},da=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).state={transcriptJson:null},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=null,t=null;return e=r.a.createElement(b.a,null,r.a.createElement(ie,{variant:"warning",heading:"Demo mode",message:la})),navigator.onLine||(t=r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null),r.a.createElement(b.a,null,r.a.createElement(ie,{variant:"warning",heading:"Offline warning",message:"You don't seem to be connected to the internet "})))),r.a.createElement(r.a.Fragment,null,e,t,r.a.createElement(u.HashRouter,null,r.a.createElement("div",null,r.a.createElement(h.g,null,r.a.createElement(h.d,{exact:!0,path:"/",component:$}),r.a.createElement(h.d,{exact:!0,path:"/projects",component:$}),r.a.createElement(h.d,{exact:!0,path:"/projects/:projectId",component:ge}),r.a.createElement(h.d,{exact:!0,path:"/projects/:projectId/transcripts/:transcriptId/correct",component:be}),r.a.createElement(h.d,{exact:!0,path:"/projects/:projectId/paperedits/:papereditId",component:ca}),r.a.createElement(h.d,{component:pa})))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(da,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[242,1,2]]]);
//# sourceMappingURL=main.71b07b4b.chunk.js.map